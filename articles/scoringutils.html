<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>scoringutils â€¢ scoringutils</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="scoringutils">
<meta property="og:description" content="scoringutils">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scoringutils</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/scoringutils.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/epiforecasts/scoringutils/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>scoringutils</h1>
                        <h4 class="author">Nikos Bosse</h4>
            
            <h4 class="date">2020-05-31</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/epiforecasts/scoringutils/blob/master/vignettes/scoringutils.Rmd"><code>vignettes/scoringutils.Rmd</code></a></small>
      <div class="hidden name"><code>scoringutils.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The scoringutils package provides a collection of metrics and proper scoring rules that make it simple to score forecasts against the true observed values. You can either automatically score predictions using <code>eval_forecasts</code> with an appropriately shaped <code>data.frame</code> as input, or you can access the different scoring metrics directly using lower level functions.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">scoringutils</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">data.table</span>)</pre></body></html></div>
</div>
<div id="scoring-forecasts-directly" class="section level1">
<h1 class="hasAnchor">
<a href="#scoring-forecasts-directly" class="anchor"></a>Scoring Forecasts Directly</h1>
<p>A variety of metrics and scoring rules can be accessed through the <code>scoringutils</code> package.</p>
<div id="bias" class="section level2">
<h2 class="hasAnchor">
<a href="#bias" class="anchor"></a>Bias</h2>
<p>The function <code>bias</code> determines bias from predictive Monte-Carlo samples, automatically recognising whether forecasts are continuous or integer valued.</p>
<p>For continuous forecasts, Bias is measured as <span class="math display">\[B_t (P_t, x_t) = 1 - 2 \cdot (P_t (x_t))\]</span></p>
<p>where <span class="math inline">\(P_t\)</span> is the empirical cumulative distribution function of the prediction for the true value <span class="math inline">\(x_t\)</span>. Computationally, <span class="math inline">\(P_t (x_t)\)</span> is just calculated as the fraction of predictive samples for <span class="math inline">\(x_t\)</span> that are smaller than <span class="math inline">\(x_t\)</span>.</p>
<p>For integer valued forecasts, Bias is measured as</p>
<p><span class="math display">\[B_t (P_t, x_t) = 1 - (P_t (x_t) + P_t (x_t + 1))\]</span></p>
<p>to adjust for the integer nature of the forecasts. In both cases, Bias can assume values between -1 and 1 and is 0 ideally.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="co">## integer valued forecasts</span>
<span class="no">true_values</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span>(<span class="fl">30</span>, <span class="kw">lambda</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">30</span>)
<span class="no">predictions</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span>(<span class="fl">200</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span>(<span class="kw">n</span> <span class="kw">=</span> <span class="fl">30</span>, <span class="kw">lambda</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">30</span>))
<span class="fu"><a href="../reference/bias.html">bias</a></span>(<span class="no">true_values</span>, <span class="no">predictions</span>)
<span class="co">#&gt;  [1] -0.115 -0.810 -0.665  0.670 -0.095 -0.310 -0.390 -0.330  0.480  0.465</span>
<span class="co">#&gt; [11] -0.070  0.740 -0.940  0.720 -0.340 -0.575  0.810  0.540  0.675  0.235</span>
<span class="co">#&gt; [21] -0.585  0.885 -0.970 -0.380 -0.945  0.565  0.975 -0.455 -0.520 -0.545</span>

<span class="co">## continuous forecasts</span>
<span class="no">true_values</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">30</span>, <span class="kw">mean</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">30</span>)
<span class="no">predictions</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span>(<span class="fl">200</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">30</span>, <span class="kw">mean</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">30</span>))
<span class="fu"><a href="../reference/bias.html">bias</a></span>(<span class="no">true_values</span>, <span class="no">predictions</span>)
<span class="co">#&gt;  [1]  0.41  0.79 -0.63 -0.84 -0.95 -0.08 -0.08  0.74  0.81  0.79  0.75  0.08</span>
<span class="co">#&gt; [13]  0.10  0.39 -0.56  0.54  0.64 -0.01 -0.09  0.15 -0.34  0.90 -0.74 -0.81</span>
<span class="co">#&gt; [25]  0.99  0.82 -0.17 -0.16  0.52 -0.64</span></pre></body></html></div>
</div>
<div id="sharpness" class="section level2">
<h2 class="hasAnchor">
<a href="#sharpness" class="anchor"></a>Sharpness</h2>
<p>Sharpness is the ability of the model to generate predictions within a narrow range. It is a data-independent measure, and is purely a feature of the forecasts themselves.</p>
<p>Shaprness of predictive samples corresponding to one single true value is measured as the normalised median of the absolute deviation from the median of the predictive samples. For details, see <code><a href="https://rdrr.io/r/stats/mad.html">?stats::mad</a></code></p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">predictions</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span>(<span class="fl">200</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span>(<span class="kw">n</span> <span class="kw">=</span> <span class="fl">30</span>, <span class="kw">lambda</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">30</span>))
<span class="fu"><a href="../reference/sharpness.html">sharpness</a></span>(<span class="no">predictions</span>)
<span class="co">#&gt;  [1] 1.4826 1.4826 1.4826 1.4826 1.4826 2.9652 2.9652 2.9652 2.9652 2.9652</span>
<span class="co">#&gt; [11] 2.9652 2.9652 2.9652 2.2239 2.9652 4.4478 4.4478 2.9652 4.4478 4.4478</span>
<span class="co">#&gt; [21] 4.4478 4.4478 5.1891 4.4478 4.4478 5.9304 4.4478 5.1891 5.9304 5.9304</span></pre></body></html></div>
</div>
<div id="calibration" class="section level2">
<h2 class="hasAnchor">
<a href="#calibration" class="anchor"></a>Calibration</h2>
<p>Calibration or reliability of forecasts is the ability of a model to correctly identify its own uncertainty in making predictions. In a model with perfect calibration, the observed data at each time point look as if they came from the predictive probability distribution at that time.</p>
<p>Equivalently, one can inspect the probability integral transform of the predictive distribution at time t,</p>
<p><span class="math display">\[u_t = F_t (x_t)\]</span></p>
<p>where <span class="math inline">\(x_t\)</span> is the observed data point at time <span class="math inline">\(t \text{ in } t_1, â€¦, t_n\)</span>, n being the number of forecasts, and <span class="math inline">\(F_t\)</span> is the (continuous) predictive cumulative probability distribution at time t. If the true probability distribution of outcomes at time t is <span class="math inline">\(G_t\)</span> then the forecasts <span class="math inline">\(F_t\)</span> are said to be ideal if <span class="math inline">\(F_t = G_t\)</span> at all times <span class="math inline">\(t\)</span>. In that case, the probabilities ut are distributed uniformly.</p>
<p>In the case of discrete outcomes such as incidence counts, the PIT is no longer uniform even when forecasts are ideal. In that case a randomised PIT can be used instead:</p>
<p><span class="math display">\[u_t = P_t(k_t) + v \cdot (P_t(k_t) - P_t(k_t - 1) )\]</span></p>
<p>where <span class="math inline">\(k_t\)</span> is the observed count, <span class="math inline">\(P_t(x)\)</span> is the predictive cumulative probability of observing incidence <span class="math inline">\(k\)</span> at time <span class="math inline">\(t\)</span>, <span class="math inline">\(P_t (-1) = 0\)</span> by definition and <span class="math inline">\(v\)</span> is standard uniform and independent of <span class="math inline">\(k\)</span>. If <span class="math inline">\(P_t\)</span> is the true cumulative probability distribution, then <span class="math inline">\(u_t\)</span> is standard uniform.</p>
<p>The function checks whether integer or continuous forecasts were provided. It then applies the (randomised) probability integral and tests the values <span class="math inline">\(u_t\)</span> for uniformity using the Anderson-Darling test.</p>
<p>As a rule of thumb, there is no evidence to suggest a forecasting model is miscalibrated if the p-value found was greater than a threshold of <span class="math inline">\(p &gt;= 0.1\)</span>, some evidence that it was miscalibrated if <span class="math inline">\(0.01 &lt; p &lt; 0.1\)</span>, and good evidence that it was miscalibrated if <span class="math inline">\(p &lt;= 0.01\)</span>. In this context it should be noted, though, that uniformity of the PIT is a necessary but not sufficient condition of calibration. It should als be noted that the test only works given sufficient samples, otherwise the Null hypothesis will often be rejected outright.</p>
</div>
<div id="continuous-ranked-probability-score-crps" class="section level2">
<h2 class="hasAnchor">
<a href="#continuous-ranked-probability-score-crps" class="anchor"></a>Continuous Ranked Probability Score (CRPS)</h2>
<p>Wrapper around the <code>crps_sample</code> function from the <code>scoringRules</code> package. For more information look at the manuals from the <code>scoringRules</code> package. The function can be used for continuous as well as integer valued forecasts. Smaller values are better.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">true_values</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span>(<span class="fl">30</span>, <span class="kw">lambda</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">30</span>)
<span class="no">predictions</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span>(<span class="fl">200</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span>(<span class="kw">n</span> <span class="kw">=</span> <span class="fl">30</span>, <span class="kw">lambda</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">30</span>))
<span class="fu"><a href="../reference/crps.html">crps</a></span>(<span class="no">true_values</span>, <span class="no">predictions</span>)
<span class="co">#&gt;  [1] 0.594850 0.458675 0.326825 0.418225 1.096050 1.871800 0.762900 0.593200</span>
<span class="co">#&gt;  [9] 1.655050 1.927375 0.727225 1.485650 6.013925 1.633775 1.468200 1.026175</span>
<span class="co">#&gt; [17] 3.687700 1.786450 1.085475 1.662525 1.139350 3.410400 2.090250 1.571600</span>
<span class="co">#&gt; [25] 3.002275 2.458950 5.277300 2.284450 1.896225 1.414850</span></pre></body></html></div>
</div>
<div id="dawid-sebastiani-score-dss" class="section level2">
<h2 class="hasAnchor">
<a href="#dawid-sebastiani-score-dss" class="anchor"></a>Dawid-Sebastiani Score (DSS)</h2>
<p>Wrapper around the <code>dss_sample</code> function from the <code>scoringRules</code> package. For more information look at the manuals from the <code>scoringRules</code> package. The function can be used for continuous as well as integer valued forecasts. Smaller values are better.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">true_values</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span>(<span class="fl">30</span>, <span class="kw">lambda</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">30</span>)
<span class="no">predictions</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span>(<span class="fl">200</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span>(<span class="kw">n</span> <span class="kw">=</span> <span class="fl">30</span>, <span class="kw">lambda</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">30</span>))
<span class="fu"><a href="../reference/dss.html">dss</a></span>(<span class="no">true_values</span>, <span class="no">predictions</span>)
<span class="co">#&gt;  [1]  1.1259661  0.6497182  2.5064954  2.2471797  1.7677784  1.9311159</span>
<span class="co">#&gt;  [7]  2.4231647  2.4708450  2.6917519  2.3271013  2.8355955  4.6150687</span>
<span class="co">#&gt; [13]  2.6152037  4.8459009 16.6452788  2.7603264  4.4249374  4.9964538</span>
<span class="co">#&gt; [19]  2.9569918  7.4440523  4.1403599  3.7802510  3.8910265  3.5665385</span>
<span class="co">#&gt; [25]  3.6446167  3.6312552  3.4667559  5.8370749  3.4127175  3.5500354</span></pre></body></html></div>
</div>
<div id="log-score" class="section level2">
<h2 class="hasAnchor">
<a href="#log-score" class="anchor"></a>Log Score</h2>
<p>Wrapper around the <code>log_sample</code> function from the <code>scoringRules</code> package. For more information look at the manuals from the <code>scoringRules</code> package. The function should not be used for integer valued forecasts. While Log Scores are in principle possible for integer valued foreasts they require a kernel density estimate which is not well defined for discrete values. Smaller values are better.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">true_values</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">30</span>, <span class="kw">mean</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">30</span>)
<span class="no">predictions</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span>(<span class="fl">200</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="kw">n</span> <span class="kw">=</span> <span class="fl">30</span>, <span class="kw">mean</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">30</span>))
<span class="fu"><a href="../reference/logs.html">logs</a></span>(<span class="no">true_values</span>, <span class="no">predictions</span>)
<span class="co">#&gt;  [1] 1.2273250 2.3203543 0.9375885 0.9977656 1.3099467 1.2363303 1.5615408</span>
<span class="co">#&gt;  [8] 1.2562029 0.9713331 2.9324562 1.0609752 1.2475889 2.9101268 1.4268964</span>
<span class="co">#&gt; [15] 1.1768102 1.1046106 1.1924584 3.2862893 1.0440618 1.1699575 1.1016912</span>
<span class="co">#&gt; [22] 1.0323393 1.8966631 1.1815514 1.2048083 0.8770541 1.2280346 1.0237177</span>
<span class="co">#&gt; [29] 1.1020511 1.2411900</span></pre></body></html></div>
</div>
<div id="brier-score" class="section level2">
<h2 class="hasAnchor">
<a href="#brier-score" class="anchor"></a>Brier Score</h2>
<p>The Brier score is a proper score rule that assesses the accuracy of probabilistic binary predictions. The outcomes can be either 0 or 1, the predictions must be a probability that the true outcome will be 1.</p>
<p>The Brier Score is then computed as the mean squared error between the probabilistic prediction and the true outcome.</p>
<p><span class="math display">\[\text{Brier_Score} = \frac{1}{N} \sum_{t = 1}^{n} (\text{prediction}_t - \text{outcome}_t)^2\]</span></p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">true_values</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">1</span>), <span class="kw">size</span> <span class="kw">=</span> <span class="fl">30</span>, <span class="kw">replace</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">predictions</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="kw">n</span> <span class="kw">=</span> <span class="fl">30</span>, <span class="kw">min</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">max</span> <span class="kw">=</span> <span class="fl">1</span>)

<span class="fu"><a href="../reference/brier_score.html">brier_score</a></span>(<span class="no">true_values</span>, <span class="no">predictions</span>)
<span class="co">#&gt; [1] 0.3658388</span></pre></body></html></div>
</div>
<div id="interval-score" class="section level2">
<h2 class="hasAnchor">
<a href="#interval-score" class="anchor"></a>Interval Score</h2>
<p>The Interval Score is a Proper Scoring Rule to score quantile predictions, following Gneiting and Raftery (2007). Smaller values are better.</p>
<p>The score is computed as</p>
<p><span class="math display">\[ \text{score} = (\text{upper} - \text{lower}) + \\
\frac{2}{\alpha} \cdot (\text{lower} - \text{true_value}) \cdot 1(\text{true_values} &lt; \text{lower}) + \\
\frac{2}{\alpha} \cdot (\text{true_value} - \text{upper}) \cdot
1(\text{true_value} &gt; \text{upper})\]</span></p>
<p>where <span class="math inline">\(1()\)</span> is the indicator function and <span class="math inline">\(\alpha\)</span> is the decimal value that indicates how much is outside the prediction interval. To improve usability, the user is asked to provide an interval range in percentage terms, i.e.Â interval_range = 90 (percent) for a 90 percent prediction interval. Correspondingly, the user would have to provide the 5% and 95% quantiles (the corresponding alpha would then be 0.1). No specific distribution is assumed, but the range has to be symmetric (i.e you canâ€™t use the 0.1 quantile as the lower bound and the 0.7 quantile as the upper). Setting <code>weigh = TRUE</code> will weigh the score by <span class="math inline">\(\frac{\alpha}{4}\)</span> such that the Interval Score converges to the CRPS for increasing number of quantiles.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">true_values</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">30</span>, <span class="kw">mean</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">30</span>)
<span class="no">interval_range</span> <span class="kw">&lt;-</span> <span class="fl">90</span>
<span class="no">alpha</span> <span class="kw">&lt;-</span> (<span class="fl">100</span> - <span class="no">interval_range</span>) / <span class="fl">100</span>
<span class="no">lower</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span>(<span class="no">alpha</span>/<span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">30</span>, <span class="kw">mean</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">30</span>))
<span class="no">upper</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span>((<span class="fl">1</span>- <span class="no">alpha</span>/<span class="fl">2</span>), <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">30</span>, <span class="kw">mean</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">30</span>))

<span class="fu"><a href="../reference/interval_score.html">interval_score</a></span>(<span class="kw">true_values</span> <span class="kw">=</span> <span class="no">true_values</span>,
               <span class="kw">lower</span> <span class="kw">=</span> <span class="no">lower</span>,
               <span class="kw">upper</span> <span class="kw">=</span> <span class="no">upper</span>,
               <span class="kw">interval_range</span> <span class="kw">=</span> <span class="no">interval_range</span>)
<span class="co">#&gt;  [1]  4.608065  4.366273 23.909712 15.012956  2.530319  5.642574  1.750432</span>
<span class="co">#&gt;  [8]  5.639222  3.346837  4.374758  1.856104  5.891992  3.520715  6.082598</span>
<span class="co">#&gt; [15]  7.551043 13.691497  6.856041 25.618009 15.202212  2.440785  4.612232</span>
<span class="co">#&gt; [22]  3.913863  5.342392  1.918604  4.151391  4.311569  4.159987 18.328841</span>
<span class="co">#&gt; [29]  4.962069  2.382738</span></pre></body></html></div>
</div>
</div>
<div id="automatically-scoring-forecasts" class="section level1">
<h1 class="hasAnchor">
<a href="#automatically-scoring-forecasts" class="anchor"></a>Automatically Scoring Forecasts</h1>
<p>The function <code>eval_forecasts</code> automatically scores forecasts. As input you need a <code>data.frame</code> with your predictions. If you want to have one score per observation, you can call the function with <code>summarised = FALSE</code>. By default, the function returns one aggregate score per model. For more information see <code><a href="../reference/eval_forecasts.html">?eval_forecasts</a></code>.</p>
<div id="scoring-probability-binary-forecasts" class="section level2">
<h2 class="hasAnchor">
<a href="#scoring-probability-binary-forecasts" class="anchor"></a>Scoring Probability Binary Forecasts</h2>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">data.table</span>)

<span class="co"># load example data</span>
<span class="no">binary_example</span> <span class="kw">&lt;-</span> <span class="kw pkg">data.table</span><span class="kw ns">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setDT.html">setDT</a></span>(<span class="kw pkg">scoringutils</span><span class="kw ns">::</span><span class="no"><a href="../reference/binary_example_data.html">binary_example_data</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">binary_example</span>, <span class="fl">3</span>, <span class="fl">3</span>)
<span class="co">#&gt;     id true_values  model predictions</span>
<span class="co">#&gt;  1:  1           0 model1 0.877283166</span>
<span class="co">#&gt;  2:  2           0 model1 0.858535155</span>
<span class="co">#&gt;  3:  3           0 model1 0.639325110</span>
<span class="co">#&gt; ---                                  </span>
<span class="co">#&gt; 58: 28           1 model2 0.259778344</span>
<span class="co">#&gt; 59: 29           0 model2 0.008900052</span>
<span class="co">#&gt; 60: 30           0 model2 0.728497056</span></pre></body></html></div>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="co"># score forecasts</span>
<span class="no">eval</span> <span class="kw">&lt;-</span> <span class="kw pkg">scoringutils</span><span class="kw ns">::</span><span class="fu"><a href="../reference/eval_forecasts.html">eval_forecasts</a></span>(<span class="no">binary_example</span>)
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">eval</span>)
<span class="co">#&gt;     model Brier_score</span>
<span class="co">#&gt; 1: model1   0.4246968</span>
<span class="co">#&gt; 2: model2   0.3071147</span></pre></body></html></div>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">eval</span> <span class="kw">&lt;-</span> <span class="kw pkg">scoringutils</span><span class="kw ns">::</span><span class="fu"><a href="../reference/eval_forecasts.html">eval_forecasts</a></span>(<span class="no">binary_example</span>, <span class="kw">summarised</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">eval</span>, <span class="fl">3</span>, <span class="fl">3</span>)
<span class="co">#&gt;     id true_values  model predictions  Brier_score</span>
<span class="co">#&gt;  1:  1           0 model1 0.877283166 7.696258e-01</span>
<span class="co">#&gt;  2:  2           0 model1 0.858535155 7.370826e-01</span>
<span class="co">#&gt;  3:  3           0 model1 0.639325110 4.087366e-01</span>
<span class="co">#&gt; ---                                               </span>
<span class="co">#&gt; 58: 28           1 model2 0.259778344 5.479281e-01</span>
<span class="co">#&gt; 59: 29           0 model2 0.008900052 7.921093e-05</span>
<span class="co">#&gt; 60: 30           0 model2 0.728497056 5.307080e-01</span></pre></body></html></div>
</div>
<div id="scoring-quantile-forecasts" class="section level2">
<h2 class="hasAnchor">
<a href="#scoring-quantile-forecasts" class="anchor"></a>Scoring Quantile Forecasts</h2>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="no">quantile_example</span> <span class="kw">&lt;-</span> <span class="kw pkg">data.table</span><span class="kw ns">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setDT.html">setDT</a></span>(<span class="kw pkg">scoringutils</span><span class="kw ns">::</span><span class="no"><a href="../reference/quantile_example_data.html">quantile_example_data</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">quantile_example</span>, <span class="fl">3</span>, <span class="fl">3</span>)
<span class="co">#&gt;     true_values id  model   lower_90   lower_50 lower_0 upper_0 upper_50</span>
<span class="co">#&gt;  1:    2.659261  1 model1 -0.6448536  0.3255102     1.0     1.0  1.67449</span>
<span class="co">#&gt;  2:    0.822062  2 model1  0.3551464  1.3255102     2.0     2.0  2.67449</span>
<span class="co">#&gt;  3:    2.865579  3 model1  1.3551464  2.3255102     3.0     3.0  3.67449</span>
<span class="co">#&gt; ---                                                                     </span>
<span class="co">#&gt; 58:   28.726896 28 model2 26.4551464 27.4255102    28.1    28.1 28.77449</span>
<span class="co">#&gt; 59:   29.446186 29 model2 27.4551464 28.4255102    29.1    29.1 29.77449</span>
<span class="co">#&gt; 60:   30.189608 30 model2 28.4551464 29.4255102    30.1    30.1 30.77449</span>
<span class="co">#&gt;      upper_90</span>
<span class="co">#&gt;  1:  2.644854</span>
<span class="co">#&gt;  2:  3.644854</span>
<span class="co">#&gt;  3:  4.644854</span>
<span class="co">#&gt; ---          </span>
<span class="co">#&gt; 58: 29.744854</span>
<span class="co">#&gt; 59: 30.744854</span>
<span class="co">#&gt; 60: 31.744854</span></pre></body></html></div>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">eval</span> <span class="kw">&lt;-</span> <span class="kw pkg">scoringutils</span><span class="kw ns">::</span><span class="fu"><a href="../reference/eval_forecasts.html">eval_forecasts</a></span>(<span class="no">quantile_example</span>)
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">eval</span>)
<span class="co">#&gt;     model Interval_Score</span>
<span class="co">#&gt; 1: model1       2.605845</span>
<span class="co">#&gt; 2: model2       2.674873</span></pre></body></html></div>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="no">eval</span> <span class="kw">&lt;-</span> <span class="kw pkg">scoringutils</span><span class="kw ns">::</span><span class="fu"><a href="../reference/eval_forecasts.html">eval_forecasts</a></span>(<span class="no">quantile_example</span>, <span class="kw">summarised</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">eval</span>, <span class="fl">3</span>, <span class="fl">3</span>)
<span class="co">#&gt;      id true_values range  model      lower    upper Interval_Score</span>
<span class="co">#&gt;   1:  1    2.659261     0 model1  1.0000000  1.00000       3.318523</span>
<span class="co">#&gt;   2:  1    2.659261     0 model2  1.1000000  1.10000       3.118523</span>
<span class="co">#&gt;   3:  1    2.659261    50 model1  0.3255102  1.67449       5.288066</span>
<span class="co">#&gt;  ---                                                               </span>
<span class="co">#&gt; 178: 30   30.189608    50 model2 29.4255102 30.77449       1.348980</span>
<span class="co">#&gt; 179: 30   30.189608    90 model1 28.3551464 31.64485       3.289707</span>
<span class="co">#&gt; 180: 30   30.189608    90 model2 28.4551464 31.74485       3.289707</span></pre></body></html></div>
</div>
<div id="scoring-integer-forecasts" class="section level2">
<h2 class="hasAnchor">
<a href="#scoring-integer-forecasts" class="anchor"></a>Scoring Integer Forecasts</h2>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="no">integer_example</span> <span class="kw">&lt;-</span> <span class="kw pkg">data.table</span><span class="kw ns">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setDT.html">setDT</a></span>(<span class="kw pkg">scoringutils</span><span class="kw ns">::</span><span class="no"><a href="../reference/integer_example_data.html">integer_example_data</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">integer_example</span>, <span class="fl">3</span>, <span class="fl">3</span>)
<span class="co">#&gt;        id  model true_values sample predictions</span>
<span class="co">#&gt;     1:  1 model1           2      1           1</span>
<span class="co">#&gt;     2:  1 model1           2      2           2</span>
<span class="co">#&gt;     3:  1 model1           2      3           1</span>
<span class="co">#&gt;    ---                                         </span>
<span class="co">#&gt; 29998: 30 model2          31    498          26</span>
<span class="co">#&gt; 29999: 30 model2          31    499          37</span>
<span class="co">#&gt; 30000: 30 model2          31    500          31</span></pre></body></html></div>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="no">eval</span> <span class="kw">&lt;-</span> <span class="kw pkg">scoringutils</span><span class="kw ns">::</span><span class="fu"><a href="../reference/eval_forecasts.html">eval_forecasts</a></span>(<span class="no">integer_example</span>)
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">eval</span>)
<span class="co">#&gt;     model sharpness      bias      DSS     CRPS  pit_p_val      pit_sd</span>
<span class="co">#&gt; 1: model1   3.78063 0.1440667 3.247092 1.800532 0.24613880 0.039191846</span>
<span class="co">#&gt; 2: model2   3.87947 0.2474667 3.404113 1.955676 0.02977548 0.007326257</span></pre></body></html></div>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="no">eval</span> <span class="kw">&lt;-</span> <span class="kw pkg">scoringutils</span><span class="kw ns">::</span><span class="fu"><a href="../reference/eval_forecasts.html">eval_forecasts</a></span>(<span class="no">integer_example</span>, <span class="kw">summarised</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">eval</span>, <span class="fl">3</span>, <span class="fl">3</span>)
<span class="co">#&gt;      model id sharpness   bias       DSS     CRPS  pit_p_val      pit_sd</span>
<span class="co">#&gt;  1: model1  1    1.4826 -0.684 1.0826668 0.703120 0.22863478 0.037530888</span>
<span class="co">#&gt;  2: model2  1    1.4826 -0.410 0.5830578 0.445968 0.02951098 0.006972111</span>
<span class="co">#&gt;  3: model1  2    1.4826 -0.532 1.1906665 0.674004 0.22863478 0.037530888</span>
<span class="co">#&gt; ---                                                                     </span>
<span class="co">#&gt; 58: model2 29    5.9304  0.542 3.9776803 2.406524 0.02951098 0.006972111</span>
<span class="co">#&gt; 59: model1 30    5.9304 -0.106 3.4417915 1.322152 0.22863478 0.037530888</span>
<span class="co">#&gt; 60: model2 30    4.4478 -0.134 3.4220738 1.258856 0.02951098 0.006972111</span></pre></body></html></div>
</div>
<div id="scoring-continuous-forecasts" class="section level2">
<h2 class="hasAnchor">
<a href="#scoring-continuous-forecasts" class="anchor"></a>Scoring Continuous Forecasts</h2>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="no">continuous_example</span> <span class="kw">&lt;-</span> <span class="kw pkg">data.table</span><span class="kw ns">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setDT.html">setDT</a></span>(<span class="kw pkg">scoringutils</span><span class="kw ns">::</span><span class="no"><a href="../reference/continuous_example_data.html">continuous_example_data</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">continuous_example</span>, <span class="fl">3</span>, <span class="fl">3</span>)
<span class="co">#&gt;       id  model true_values sample  predictions</span>
<span class="co">#&gt;    1:  1 model1  0.03007379      1 -0.203426069</span>
<span class="co">#&gt;    2:  1 model1  0.03007379      2  0.007621269</span>
<span class="co">#&gt;    3:  1 model1  0.03007379      3 -2.086657003</span>
<span class="co">#&gt;   ---                                          </span>
<span class="co">#&gt; 2998: 30 model2 -2.93749990     48  0.333292940</span>
<span class="co">#&gt; 2999: 30 model2 -2.93749990     49 -2.369034642</span>
<span class="co">#&gt; 3000: 30 model2 -2.93749990     50 -0.144544426</span></pre></body></html></div>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="no">eval</span> <span class="kw">&lt;-</span> <span class="kw pkg">scoringutils</span><span class="kw ns">::</span><span class="fu"><a href="../reference/eval_forecasts.html">eval_forecasts</a></span>(<span class="no">continuous_example</span>)
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">eval</span>)
<span class="co">#&gt;     model sharpness         bias      DSS      CRPS     LogS pit_p_val</span>
<span class="co">#&gt; 1: model1 0.9614030 -0.070666667 1.728001 0.7596405 1.826296     2e-05</span>
<span class="co">#&gt; 2: model2 0.9640941 -0.006666667 1.624224 0.7417875 1.804958     2e-05</span></pre></body></html></div>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="no">eval</span> <span class="kw">&lt;-</span> <span class="kw pkg">scoringutils</span><span class="kw ns">::</span><span class="fu"><a href="../reference/eval_forecasts.html">eval_forecasts</a></span>(<span class="no">continuous_example</span>, <span class="kw">summarised</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">eval</span>, <span class="fl">3</span>, <span class="fl">3</span>)
<span class="co">#&gt;      model id sharpness  bias         DSS      CRPS     LogS pit_p_val</span>
<span class="co">#&gt;  1: model1  1 1.1283071  0.04 -0.08898351 0.2580341 1.093753     2e-05</span>
<span class="co">#&gt;  2: model2  1 1.0705271 -0.04  0.07987778 0.2556484 1.087163     2e-05</span>
<span class="co">#&gt;  3: model1  2 1.0057182 -0.92  3.06985466 1.2193656 2.370296     2e-05</span>
<span class="co">#&gt; ---                                                                   </span>
<span class="co">#&gt; 58: model2 29 0.9827873 -0.76  1.13727388 0.6572423 1.489301     2e-05</span>
<span class="co">#&gt; 59: model1 30 0.9887154  1.00  8.70563844 2.2980866 4.012829     2e-05</span>
<span class="co">#&gt; 60: model2 30 0.9985101  0.96  6.58413707 2.3375785 3.107910     2e-05</span></pre></body></html></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Nikos Bosse, Sam Abbott, Sebastian Funk.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
