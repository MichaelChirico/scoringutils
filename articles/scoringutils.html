<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="scoringutils">
<title>Getting started • scoringutils</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting started">
<meta property="og:description" content="scoringutils">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">scoringutils</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.2.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/scoringutils.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/metric-details.html">Details on the metrics implemented in `scoringutils`</a>
    <a class="dropdown-item" href="../articles/scoring-forecasts-directly.html">Scoring forecasts directly</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/epiforecasts/scoringutils/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Getting started</h1>
                        <h4 data-toc-skip class="author">Nikos
Bosse</h4>
            
            <h4 data-toc-skip class="date">2023-12-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/epiforecasts/scoringutils/blob/HEAD/vignettes/scoringutils.Rmd" class="external-link"><code>vignettes/scoringutils.Rmd</code></a></small>
      <div class="d-none name"><code>scoringutils.Rmd</code></div>
    </div>

    
    
<p>The <code>scoringutils</code> package provides a collection of
metrics and proper scoring rules that make it simple to score
probabilistic forecasts against the true observed values. You can find
more information in the paper <a href="https://arxiv.org/abs/2205.07090" class="external-link">Evaluating Forecasts with
scoringutils in R</a> as well as the <a href="https://epiforecasts.io/scoringutils/articles/metric-details.html">Metrics-Vignette</a>
and the <a href="https://epiforecasts.io/scoringutils/articles/scoring-forecasts-directly.html">Scoring
forecasts directly Vignette</a>.</p>
<p>The <code>scoringutils</code> package offers convenient automated
forecast evaluation in a <code>data.table</code> format (using the
function <code><a href="../reference/score.html">score()</a></code>), but also provides experienced users with
a set of reliable lower-level scoring metrics operating on
vectors/matriced they can build upon in other applications. In addition
it implements a wide range of flexible plots that are able to cover many
use cases.</p>
<p>The goal of this package is to provide a tested and reliable
collection of metrics that can be used for scoring probabilistic
forecasts (forecasts with a full predictive distribution, rather than
point forecasts). It has a much stronger focus on convenience than
e.g. the <code>scoringRules</code> package, which provides a
comprehensive collection of proper scoring rules (also used in
<code>scoringutils</code>). In contrast to other packages,
<code>scoringutils</code> offers functionality to automatically evaluate
forecasts, to visualise scores and to obtain relative scores between
models.</p>
<p>Predictions can be handled in various formats:
<code>scoringutils</code> can handle probabilistic forecasts in either a
sample based or a quantile based format. For more detail on the expected
input formats please see below. True values can be integer, continuous
or binary.</p>
<div class="section level2">
<h2 id="input-formats">Input formats<a class="anchor" aria-label="anchor" href="#input-formats"></a>
</h2>
<p>Most of the time, the <code><a href="../reference/score.html">score()</a></code> function will be able to
do the entire evaluation for you. All you need to do is to pass in a
<code>data.frame</code> with the appropriate columns. Which columns are
required depends on the format the forecasts come in. The forecast
format can either be based on quantiles (see
<code>example_quantile</code> for the expected format), based on
predictive samples (see <code>example_continuous</code> and
<code>example_integer</code> for the expected format in each case) or in
a binary format. The following table gives an overview (pairwise
comparisons will be explained in more detail below):</p>
<table class="table">
<thead><tr class="header">
<th align="left">Format</th>
<th align="left">Required columns</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">quantile-based</td>
<td align="left">‘true_value’, ‘prediction’, ‘quantile’</td>
</tr>
<tr class="even">
<td align="left">sample-based</td>
<td align="left">‘true_value’, ‘prediction’, ‘sample’</td>
</tr>
<tr class="odd">
<td align="left">binary</td>
<td align="left">‘true_value’, ‘prediction’</td>
</tr>
<tr class="even">
<td align="left">pairwise-comparisons</td>
<td align="left">additionally a column ‘model’</td>
</tr>
</tbody>
</table>
<p>Additional columns may be present to indicate a grouping of
forecasts. For example, we could have forecasts made by different models
in various locations at different time points, each for several weeks
into the future. <code>scoringutils</code> automatically tries to
determine the <em>unit of a single forecast</em>, i.e. the combination
of existing columns that are able to uniquely identify a single
forecast. It uses all existing columns for this, which can sometimes
lead to issues. We therefore recommend using the function
<code><a href="../reference/set_forecast_unit.html">set_forecast_unit()</a></code> to determine the forecast unit
manually. The function simply drops unneeded columns, while making sure
that some necessary, ‘protected columns’ like “prediction” or
“true_value” are retained.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">example_quantile</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "location"        "target_end_date" "target_type"     "true_value"     </span></span>
<span><span class="co">#&gt;  [5] "location_name"   "forecast_date"   "quantile"        "prediction"     </span></span>
<span><span class="co">#&gt;  [9] "model"           "horizon"</span></span>
<span></span>
<span><span class="fu"><a href="../reference/set_forecast_unit.html">set_forecast_unit</a></span><span class="op">(</span></span>
<span>  <span class="va">example_quantile</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"location"</span>, <span class="st">"target_end_date"</span>, <span class="st">"target_type"</span>, <span class="st">"horizon"</span>, <span class="st">"model"</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "true_value"      "quantile"        "prediction"      "location"       </span></span>
<span><span class="co">#&gt; [5] "target_end_date" "target_type"     "horizon"         "model"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="checking-the-input-data">Checking the input data<a class="anchor" aria-label="anchor" href="#checking-the-input-data"></a>
</h2>
<p>The function <code><a href="../reference/check_forecasts.html">check_forecasts()</a></code> can be used to check the
input data. It gives a summary of what <code>scoringutils</code> thinks
you are trying to achieve. It infers the type of the prediction target,
the prediction format, and the unit of a single forecasts, gives an
overview of the number of unique values per column (helpful for spotting
missing data) and returns warnings or errors.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">example_quantile</span><span class="op">)</span></span>
<span><span class="co">#&gt;    location target_end_date target_type true_value location_name forecast_date</span></span>
<span><span class="co">#&gt; 1:       DE      2021-01-02       Cases     127300       Germany          &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2:       DE      2021-01-02      Deaths       4534       Germany          &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3:       DE      2021-01-09       Cases     154922       Germany          &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4:       DE      2021-01-09      Deaths       6117       Germany          &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 5:       DE      2021-01-16       Cases     110183       Germany          &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 6:       DE      2021-01-16      Deaths       5867       Germany          &lt;NA&gt;</span></span>
<span><span class="co">#&gt;    quantile prediction model horizon</span></span>
<span><span class="co">#&gt; 1:       NA         NA  &lt;NA&gt;      NA</span></span>
<span><span class="co">#&gt; 2:       NA         NA  &lt;NA&gt;      NA</span></span>
<span><span class="co">#&gt; 3:       NA         NA  &lt;NA&gt;      NA</span></span>
<span><span class="co">#&gt; 4:       NA         NA  &lt;NA&gt;      NA</span></span>
<span><span class="co">#&gt; 5:       NA         NA  &lt;NA&gt;      NA</span></span>
<span><span class="co">#&gt; 6:       NA         NA  &lt;NA&gt;      NA</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check_forecasts.html">check_forecasts</a></span><span class="op">(</span><span class="va">example_quantile</span><span class="op">)</span></span>
<span><span class="co">#&gt; The following messages were produced when checking inputs:</span></span>
<span><span class="co">#&gt; 1.  144 values for `prediction` are NA in the data provided and the corresponding rows were removed. This may indicate a problem if unexpected.</span></span>
<span><span class="co">#&gt; Your forecasts seem to be for a target of the following type:</span></span>
<span><span class="co">#&gt; $target_type</span></span>
<span><span class="co">#&gt; [1] "integer"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; and in the following format:</span></span>
<span><span class="co">#&gt; $prediction_type</span></span>
<span><span class="co">#&gt; [1] "quantile"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The unit of a single forecast is defined by:</span></span>
<span><span class="co">#&gt; $forecast_unit</span></span>
<span><span class="co">#&gt; [1] "location"        "target_end_date" "target_type"     "location_name"  </span></span>
<span><span class="co">#&gt; [5] "forecast_date"   "model"           "horizon"        </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Cleaned data, rows with NA values in prediction or true_value removed:</span></span>
<span><span class="co">#&gt; $cleaned_data</span></span>
<span><span class="co">#&gt;        location target_end_date target_type true_value location_name</span></span>
<span><span class="co">#&gt;     1:       DE      2021-05-08       Cases     106987       Germany</span></span>
<span><span class="co">#&gt;     2:       DE      2021-05-08       Cases     106987       Germany</span></span>
<span><span class="co">#&gt;     3:       DE      2021-05-08       Cases     106987       Germany</span></span>
<span><span class="co">#&gt;     4:       DE      2021-05-08       Cases     106987       Germany</span></span>
<span><span class="co">#&gt;     5:       DE      2021-05-08       Cases     106987       Germany</span></span>
<span><span class="co">#&gt;    ---                                                              </span></span>
<span><span class="co">#&gt; 20397:       IT      2021-07-24      Deaths         78         Italy</span></span>
<span><span class="co">#&gt; 20398:       IT      2021-07-24      Deaths         78         Italy</span></span>
<span><span class="co">#&gt; 20399:       IT      2021-07-24      Deaths         78         Italy</span></span>
<span><span class="co">#&gt; 20400:       IT      2021-07-24      Deaths         78         Italy</span></span>
<span><span class="co">#&gt; 20401:       IT      2021-07-24      Deaths         78         Italy</span></span>
<span><span class="co">#&gt;        forecast_date quantile prediction                 model horizon</span></span>
<span><span class="co">#&gt;     1:    2021-05-03    0.010      82466 EuroCOVIDhub-ensemble       1</span></span>
<span><span class="co">#&gt;     2:    2021-05-03    0.025      86669 EuroCOVIDhub-ensemble       1</span></span>
<span><span class="co">#&gt;     3:    2021-05-03    0.050      90285 EuroCOVIDhub-ensemble       1</span></span>
<span><span class="co">#&gt;     4:    2021-05-03    0.100      95341 EuroCOVIDhub-ensemble       1</span></span>
<span><span class="co">#&gt;     5:    2021-05-03    0.150      99171 EuroCOVIDhub-ensemble       1</span></span>
<span><span class="co">#&gt;    ---                                                                </span></span>
<span><span class="co">#&gt; 20397:    2021-07-12    0.850        352  epiforecasts-EpiNow2       2</span></span>
<span><span class="co">#&gt; 20398:    2021-07-12    0.900        397  epiforecasts-EpiNow2       2</span></span>
<span><span class="co">#&gt; 20399:    2021-07-12    0.950        499  epiforecasts-EpiNow2       2</span></span>
<span><span class="co">#&gt; 20400:    2021-07-12    0.975        611  epiforecasts-EpiNow2       2</span></span>
<span><span class="co">#&gt; 20401:    2021-07-12    0.990        719  epiforecasts-EpiNow2       2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of unique values per column per model:</span></span>
<span><span class="co">#&gt; $unique_values</span></span>
<span><span class="co">#&gt;                    model location target_end_date target_type true_value</span></span>
<span><span class="co">#&gt; 1: EuroCOVIDhub-ensemble        4              12           2         96</span></span>
<span><span class="co">#&gt; 2: EuroCOVIDhub-baseline        4              12           2         96</span></span>
<span><span class="co">#&gt; 3:  epiforecasts-EpiNow2        4              12           2         95</span></span>
<span><span class="co">#&gt; 4:       UMass-MechBayes        4              12           1         48</span></span>
<span><span class="co">#&gt;    location_name forecast_date quantile prediction horizon</span></span>
<span><span class="co">#&gt; 1:             4            11       23       3969       3</span></span>
<span><span class="co">#&gt; 2:             4            11       23       3733       3</span></span>
<span><span class="co">#&gt; 3:             4            11       23       3903       3</span></span>
<span><span class="co">#&gt; 4:             4            11       23       1058       3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $messages</span></span>
<span><span class="co">#&gt; [1] "144 values for `prediction` are NA in the data provided and the corresponding rows were removed. This may indicate a problem if unexpected."</span></span></code></pre></div>
<p>If you are unsure what your input data should look like, have a look
at the <code>example_quantile</code>, <code>example_integer</code>,
<code>example_continuous</code> and <code>example_binary</code> data
sets provided in the package.</p>
<p>The output of <code><a href="../reference/check_forecasts.html">check_forecasts()</a></code> can later be directly
used as input to <code><a href="../reference/score.html">score()</a></code> (otherwise, <code><a href="../reference/score.html">score()</a></code>
will just run <code><a href="../reference/check_forecasts.html">check_forecasts()</a></code> anyway internally).</p>
</div>
<div class="section level2">
<h2 id="showing-available-forecasts">Showing available forecasts<a class="anchor" aria-label="anchor" href="#showing-available-forecasts"></a>
</h2>
<p>The function <code><a href="../reference/avail_forecasts.html">avail_forecasts()</a></code> may also be helpful to
determine where forecasts are available. Using the <code>by</code>
argument you can specify the level of summary. For example, to see how
many forecasts there are per model and target_type, we can run</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/avail_forecasts.html">avail_forecasts</a></span><span class="op">(</span><span class="va">example_quantile</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"model"</span>, <span class="st">"target_type"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; The following messages were produced when checking inputs:</span></span>
<span><span class="co">#&gt; 1.  144 values for `prediction` are NA in the data provided and the corresponding rows were removed. This may indicate a problem if unexpected.</span></span>
<span><span class="co">#&gt;                    model target_type Number forecasts</span></span>
<span><span class="co">#&gt; 1: EuroCOVIDhub-ensemble       Cases              128</span></span>
<span><span class="co">#&gt; 2: EuroCOVIDhub-baseline       Cases              128</span></span>
<span><span class="co">#&gt; 3:  epiforecasts-EpiNow2       Cases              128</span></span>
<span><span class="co">#&gt; 4: EuroCOVIDhub-ensemble      Deaths              128</span></span>
<span><span class="co">#&gt; 5: EuroCOVIDhub-baseline      Deaths              128</span></span>
<span><span class="co">#&gt; 6:       UMass-MechBayes      Deaths              128</span></span>
<span><span class="co">#&gt; 7:  epiforecasts-EpiNow2      Deaths              119</span></span></code></pre></div>
<p>We see that ‘epiforecasts-EpiNow2’ has some missing forecasts for the
deaths forecast target and that UMass-MechBayes has no case
forecasts.</p>
<p>This information can also be visualised using the
<code><a href="../reference/plot_avail_forecasts.html">plot_avail_forecasts()</a></code> function:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_quantile</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/avail_forecasts.html">avail_forecasts</a></span><span class="op">(</span>by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"model"</span>, <span class="st">"forecast_date"</span>, <span class="st">"target_type"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/plot_avail_forecasts.html">plot_avail_forecasts</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">target_type</span><span class="op">)</span></span>
<span><span class="co">#&gt; The following messages were produced when checking inputs:</span></span>
<span><span class="co">#&gt; 1.  144 values for `prediction` are NA in the data provided and the corresponding rows were removed. This may indicate a problem if unexpected.</span></span></code></pre></div>
<p><img src="scoringutils_files/figure-html/unnamed-chunk-6-1.png" width="1056"></p>
<p>You can also visualise forecasts directly using the
<code><a href="../reference/plot_predictions.html">plot_predictions()</a></code> function:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_quantile</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/make_NA.html">make_NA</a></span><span class="op">(</span></span>
<span>    what <span class="op">=</span> <span class="st">"truth"</span>,</span>
<span>    <span class="va">target_end_date</span> <span class="op">&gt;=</span> <span class="st">"2021-07-15"</span>,</span>
<span>    <span class="va">target_end_date</span> <span class="op">&lt;</span> <span class="st">"2021-05-22"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/make_NA.html">make_NA</a></span><span class="op">(</span></span>
<span>    what <span class="op">=</span> <span class="st">"forecast"</span>,</span>
<span>    <span class="va">model</span> <span class="op">!=</span> <span class="st">"EuroCOVIDhub-ensemble"</span>,</span>
<span>    <span class="va">forecast_date</span> <span class="op">!=</span> <span class="st">"2021-06-28"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/plot_predictions.html">plot_predictions</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"target_end_date"</span>,</span>
<span>    by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"target_type"</span>, <span class="st">"location"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="va">target_type</span> <span class="op">~</span> <span class="va">location</span>, ncol <span class="op">=</span> <span class="fl">4</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span></code></pre></div>
<p><img src="scoringutils_files/figure-html/unnamed-chunk-7-1.png" width="864"></p>
</div>
<div class="section level2">
<h2 id="scoring-and-summarising-forecasts">Scoring and summarising forecasts<a class="anchor" aria-label="anchor" href="#scoring-and-summarising-forecasts"></a>
</h2>
<p>Forecasts can easily be scored using the <code><a href="../reference/score.html">score()</a></code>
function.</p>
<p>For clarity, we suggest setting the forecast unit explicitly and you
may also want to call <code><a href="../reference/check_forecasts.html">check_forecasts()</a></code> explicitly.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scores</span> <span class="op">&lt;-</span> <span class="va">example_quantile</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/set_forecast_unit.html">set_forecast_unit</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"location"</span>, <span class="st">"target_end_date"</span>, <span class="st">"target_type"</span>, <span class="st">"location_name"</span>,</span>
<span>      <span class="st">"forecast_date"</span>, <span class="st">"model"</span>, <span class="st">"horizon"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/check_forecasts.html">check_forecasts</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/score.html">score</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; The following messages were produced when checking inputs:</span></span>
<span><span class="co">#&gt; 1.  144 values for `prediction` are NA in the data provided and the corresponding rows were removed. This may indicate a problem if unexpected.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">scores</span><span class="op">)</span></span>
<span><span class="co">#&gt;    location target_end_date target_type location_name forecast_date</span></span>
<span><span class="co">#&gt; 1:       DE      2021-05-08       Cases       Germany    2021-05-03</span></span>
<span><span class="co">#&gt; 2:       DE      2021-05-08       Cases       Germany    2021-05-03</span></span>
<span><span class="co">#&gt; 3:       DE      2021-05-08       Cases       Germany    2021-05-03</span></span>
<span><span class="co">#&gt; 4:       DE      2021-05-08       Cases       Germany    2021-05-03</span></span>
<span><span class="co">#&gt; 5:       DE      2021-05-08       Cases       Germany    2021-05-03</span></span>
<span><span class="co">#&gt; 6:       DE      2021-05-08       Cases       Germany    2021-05-03</span></span>
<span><span class="co">#&gt;                    model horizon range interval_score dispersion</span></span>
<span><span class="co">#&gt; 1: EuroCOVIDhub-baseline       1     0        25620.0        0.0</span></span>
<span><span class="co">#&gt; 2: EuroCOVIDhub-baseline       1    10        25599.5      184.5</span></span>
<span><span class="co">#&gt; 3: EuroCOVIDhub-baseline       1    10        25599.5      184.5</span></span>
<span><span class="co">#&gt; 4: EuroCOVIDhub-baseline       1    20        25481.0      556.0</span></span>
<span><span class="co">#&gt; 5: EuroCOVIDhub-baseline       1    20        25481.0      556.0</span></span>
<span><span class="co">#&gt; 6: EuroCOVIDhub-baseline       1    30        25270.2      816.2</span></span>
<span><span class="co">#&gt;    underprediction overprediction coverage coverage_deviation bias quantile</span></span>
<span><span class="co">#&gt; 1:               0          25620        0                0.0 0.95     0.50</span></span>
<span><span class="co">#&gt; 2:               0          25415        0               -0.1 0.95     0.45</span></span>
<span><span class="co">#&gt; 3:               0          25415        0               -0.1 0.95     0.55</span></span>
<span><span class="co">#&gt; 4:               0          24925        0               -0.2 0.95     0.40</span></span>
<span><span class="co">#&gt; 5:               0          24925        0               -0.2 0.95     0.60</span></span>
<span><span class="co">#&gt; 6:               0          24454        0               -0.3 0.95     0.35</span></span>
<span><span class="co">#&gt;    ae_median quantile_coverage</span></span>
<span><span class="co">#&gt; 1:     25620              TRUE</span></span>
<span><span class="co">#&gt; 2:     25620              TRUE</span></span>
<span><span class="co">#&gt; 3:     25620              TRUE</span></span>
<span><span class="co">#&gt; 4:     25620              TRUE</span></span>
<span><span class="co">#&gt; 5:     25620              TRUE</span></span>
<span><span class="co">#&gt; 6:     25620              TRUE</span></span></code></pre></div>
<p>Note that in the above example some columns contain duplicated
information with regards to the forecast unit, e.g. “location” and
“location_name”, and could be dropped.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_quantile</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/set_forecast_unit.html">set_forecast_unit</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"location"</span>, <span class="st">"target_end_date"</span>, <span class="st">"target_type"</span>,</span>
<span>      <span class="st">"forecast_date"</span>, <span class="st">"model"</span>, <span class="st">"horizon"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/check_forecasts.html">check_forecasts</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; The following messages were produced when checking inputs:</span></span>
<span><span class="co">#&gt; 1.  144 values for `prediction` are NA in the data provided and the corresponding rows were removed. This may indicate a problem if unexpected.</span></span>
<span><span class="co">#&gt; Your forecasts seem to be for a target of the following type:</span></span>
<span><span class="co">#&gt; $target_type</span></span>
<span><span class="co">#&gt; [1] "integer"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; and in the following format:</span></span>
<span><span class="co">#&gt; $prediction_type</span></span>
<span><span class="co">#&gt; [1] "quantile"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The unit of a single forecast is defined by:</span></span>
<span><span class="co">#&gt; $forecast_unit</span></span>
<span><span class="co">#&gt; [1] "location"        "target_end_date" "target_type"     "forecast_date"  </span></span>
<span><span class="co">#&gt; [5] "model"           "horizon"        </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Cleaned data, rows with NA values in prediction or true_value removed:</span></span>
<span><span class="co">#&gt; $cleaned_data</span></span>
<span><span class="co">#&gt;        true_value quantile prediction location target_end_date target_type</span></span>
<span><span class="co">#&gt;     1:     106987    0.010      82466       DE      2021-05-08       Cases</span></span>
<span><span class="co">#&gt;     2:     106987    0.025      86669       DE      2021-05-08       Cases</span></span>
<span><span class="co">#&gt;     3:     106987    0.050      90285       DE      2021-05-08       Cases</span></span>
<span><span class="co">#&gt;     4:     106987    0.100      95341       DE      2021-05-08       Cases</span></span>
<span><span class="co">#&gt;     5:     106987    0.150      99171       DE      2021-05-08       Cases</span></span>
<span><span class="co">#&gt;    ---                                                                    </span></span>
<span><span class="co">#&gt; 20397:         78    0.850        352       IT      2021-07-24      Deaths</span></span>
<span><span class="co">#&gt; 20398:         78    0.900        397       IT      2021-07-24      Deaths</span></span>
<span><span class="co">#&gt; 20399:         78    0.950        499       IT      2021-07-24      Deaths</span></span>
<span><span class="co">#&gt; 20400:         78    0.975        611       IT      2021-07-24      Deaths</span></span>
<span><span class="co">#&gt; 20401:         78    0.990        719       IT      2021-07-24      Deaths</span></span>
<span><span class="co">#&gt;        forecast_date                 model horizon</span></span>
<span><span class="co">#&gt;     1:    2021-05-03 EuroCOVIDhub-ensemble       1</span></span>
<span><span class="co">#&gt;     2:    2021-05-03 EuroCOVIDhub-ensemble       1</span></span>
<span><span class="co">#&gt;     3:    2021-05-03 EuroCOVIDhub-ensemble       1</span></span>
<span><span class="co">#&gt;     4:    2021-05-03 EuroCOVIDhub-ensemble       1</span></span>
<span><span class="co">#&gt;     5:    2021-05-03 EuroCOVIDhub-ensemble       1</span></span>
<span><span class="co">#&gt;    ---                                            </span></span>
<span><span class="co">#&gt; 20397:    2021-07-12  epiforecasts-EpiNow2       2</span></span>
<span><span class="co">#&gt; 20398:    2021-07-12  epiforecasts-EpiNow2       2</span></span>
<span><span class="co">#&gt; 20399:    2021-07-12  epiforecasts-EpiNow2       2</span></span>
<span><span class="co">#&gt; 20400:    2021-07-12  epiforecasts-EpiNow2       2</span></span>
<span><span class="co">#&gt; 20401:    2021-07-12  epiforecasts-EpiNow2       2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of unique values per column per model:</span></span>
<span><span class="co">#&gt; $unique_values</span></span>
<span><span class="co">#&gt;                    model true_value quantile prediction location</span></span>
<span><span class="co">#&gt; 1: EuroCOVIDhub-ensemble         96       23       3969        4</span></span>
<span><span class="co">#&gt; 2: EuroCOVIDhub-baseline         96       23       3733        4</span></span>
<span><span class="co">#&gt; 3:  epiforecasts-EpiNow2         95       23       3903        4</span></span>
<span><span class="co">#&gt; 4:       UMass-MechBayes         48       23       1058        4</span></span>
<span><span class="co">#&gt;    target_end_date target_type forecast_date horizon</span></span>
<span><span class="co">#&gt; 1:              12           2            11       3</span></span>
<span><span class="co">#&gt; 2:              12           2            11       3</span></span>
<span><span class="co">#&gt; 3:              12           2            11       3</span></span>
<span><span class="co">#&gt; 4:              12           1            11       3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $messages</span></span>
<span><span class="co">#&gt; [1] "144 values for `prediction` are NA in the data provided and the corresponding rows were removed. This may indicate a problem if unexpected."</span></span></code></pre></div>
<p>If we drop essential information, for example, the “target_type”
column, we’ll get an error informing us that the forecasts aren’t
uniquely identified any more.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_quantile</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/set_forecast_unit.html">set_forecast_unit</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"location"</span>, <span class="st">"target_end_date"</span>,</span>
<span>      <span class="st">"forecast_date"</span>, <span class="st">"model"</span>, <span class="st">"horizon"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/check_forecasts.html">check_forecasts</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; The following messages were produced when checking inputs:</span></span>
<span><span class="co">#&gt; 1.  144 values for `prediction` are NA in the data provided and the corresponding rows were removed. This may indicate a problem if unexpected.</span></span>
<span><span class="co">#&gt; Warning in check_forecasts(.): The following warnings were produced when checking inputs:</span></span>
<span><span class="co">#&gt; 1.  Some forecasts have different numbers of rows </span></span>
<span><span class="co">#&gt; 2.  (e.g. quantiles or samples). </span></span>
<span><span class="co">#&gt; 3.  scoringutils found: </span></span>
<span><span class="co">#&gt; 4.  46, 23</span></span>
<span><span class="co">#&gt; 5.  . This may be a problem (it can potentially distort scores, </span></span>
<span><span class="co">#&gt; 6.  making it more difficult to compare them), </span></span>
<span><span class="co">#&gt; 7.  so make sure this is intended.</span></span>
<span><span class="co">#&gt; Error in check_forecasts(.): The following errors were produced when checking inputs:</span></span>
<span><span class="co">#&gt; 1.  There are instances with more than one forecast for the same target. This can't be right and needs to be resolved. Maybe you need to check the unit of a single forecast and add missing columns? Use the  function find_duplicates() to identify duplicate rows.</span></span></code></pre></div>
<p>The function <code><a href="../reference/find_duplicates.html">find_duplicates()</a></code> may help to investigate
the issue. When filtering for only median forecasts of the
EuroCOVIDhub-ensemble, we can see that there are indeed two forecasts
for every date, location and horizon.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">duplicates</span> <span class="op">&lt;-</span> <span class="va">example_quantile</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/set_forecast_unit.html">set_forecast_unit</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"location"</span>, <span class="st">"target_end_date"</span>,</span>
<span>      <span class="st">"forecast_date"</span>, <span class="st">"model"</span>, <span class="st">"horizon"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/find_duplicates.html">find_duplicates</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">duplicates</span><span class="op">[</span><span class="va">quantile</span> <span class="op">==</span> <span class="fl">0.5</span> <span class="op">&amp;</span> <span class="va">model</span> <span class="op">==</span> <span class="st">"EuroCOVIDhub-ensemble"</span>, <span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;    true_value quantile prediction location target_end_date forecast_date</span></span>
<span><span class="co">#&gt; 1:     106987      0.5     119258       DE      2021-05-08    2021-05-03</span></span>
<span><span class="co">#&gt; 2:       1582      0.5       1568       DE      2021-05-08    2021-05-03</span></span>
<span><span class="co">#&gt; 3:      64985      0.5     110716       DE      2021-05-15    2021-05-03</span></span>
<span><span class="co">#&gt; 4:      64985      0.5      92649       DE      2021-05-15    2021-05-10</span></span>
<span><span class="co">#&gt; 5:       1311      0.5       1521       DE      2021-05-15    2021-05-03</span></span>
<span><span class="co">#&gt; 6:       1311      0.5       1422       DE      2021-05-15    2021-05-10</span></span>
<span><span class="co">#&gt;                    model horizon</span></span>
<span><span class="co">#&gt; 1: EuroCOVIDhub-ensemble       1</span></span>
<span><span class="co">#&gt; 2: EuroCOVIDhub-ensemble       1</span></span>
<span><span class="co">#&gt; 3: EuroCOVIDhub-ensemble       2</span></span>
<span><span class="co">#&gt; 4: EuroCOVIDhub-ensemble       1</span></span>
<span><span class="co">#&gt; 5: EuroCOVIDhub-ensemble       2</span></span>
<span><span class="co">#&gt; 6: EuroCOVIDhub-ensemble       1</span></span></code></pre></div>
<p>The function <code><a href="../reference/score.html">score()</a></code> returns unsumarised scores, which
in most cases is not what the user wants. It returns a single score per
forecast (as determined by the forecast unit). For forecasts in a
quantile format, it returns one score per quantile.</p>
<p>A second function, <code><a href="../reference/summarise_scores.html">summarise_scores()</a></code> takes care of
summarising these scores to the level specified by the user. The
<code>by</code> argument can be used to define the level of summary. By
default, <code>by = NULL</code> and the summary unit is assumed to be
the same as the unit of a single forecast. For continuous forecasts,
this means that nothing happens if <code>by</code> isn’t specified.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/score.html">score</a></span><span class="op">(</span><span class="va">example_continuous</span><span class="op">)</span></span>
<span><span class="co">#&gt; The following messages were produced when checking inputs:</span></span>
<span><span class="co">#&gt; 1.  144 values for `prediction` are NA in the data provided and the corresponding rows were removed. This may indicate a problem if unexpected.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">scores</span> <span class="op">==</span> <span class="fu"><a href="../reference/summarise_scores.html">summarise_scores</a></span><span class="op">(</span><span class="va">scores</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>For quantile based forecasts, if <code>by = NULL</code>, then scores
are summarised across quantiles and instead of one score per
forecast_unit and quantile we only get one score per forecast unit.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scores</span> <span class="op">&lt;-</span> <span class="va">example_quantile</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/set_forecast_unit.html">set_forecast_unit</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"location"</span>, <span class="st">"target_end_date"</span>, <span class="st">"target_type"</span>,</span>
<span>      <span class="st">"forecast_date"</span>, <span class="st">"model"</span>, <span class="st">"horizon"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/check_forecasts.html">check_forecasts</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/score.html">score</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; The following messages were produced when checking inputs:</span></span>
<span><span class="co">#&gt; 1.  144 values for `prediction` are NA in the data provided and the corresponding rows were removed. This may indicate a problem if unexpected.</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">scores</span><span class="op">)</span></span>
<span><span class="co">#&gt;    location target_end_date target_type forecast_date                 model</span></span>
<span><span class="co">#&gt; 1:       DE      2021-05-08       Cases    2021-05-03 EuroCOVIDhub-baseline</span></span>
<span><span class="co">#&gt; 2:       DE      2021-05-08       Cases    2021-05-03 EuroCOVIDhub-baseline</span></span>
<span><span class="co">#&gt; 3:       DE      2021-05-08       Cases    2021-05-03 EuroCOVIDhub-baseline</span></span>
<span><span class="co">#&gt; 4:       DE      2021-05-08       Cases    2021-05-03 EuroCOVIDhub-baseline</span></span>
<span><span class="co">#&gt; 5:       DE      2021-05-08       Cases    2021-05-03 EuroCOVIDhub-baseline</span></span>
<span><span class="co">#&gt; 6:       DE      2021-05-08       Cases    2021-05-03 EuroCOVIDhub-baseline</span></span>
<span><span class="co">#&gt;    horizon range interval_score dispersion underprediction overprediction</span></span>
<span><span class="co">#&gt; 1:       1     0        25620.0        0.0               0          25620</span></span>
<span><span class="co">#&gt; 2:       1    10        25599.5      184.5               0          25415</span></span>
<span><span class="co">#&gt; 3:       1    10        25599.5      184.5               0          25415</span></span>
<span><span class="co">#&gt; 4:       1    20        25481.0      556.0               0          24925</span></span>
<span><span class="co">#&gt; 5:       1    20        25481.0      556.0               0          24925</span></span>
<span><span class="co">#&gt; 6:       1    30        25270.2      816.2               0          24454</span></span>
<span><span class="co">#&gt;    coverage coverage_deviation bias quantile ae_median quantile_coverage</span></span>
<span><span class="co">#&gt; 1:        0                0.0 0.95     0.50     25620              TRUE</span></span>
<span><span class="co">#&gt; 2:        0               -0.1 0.95     0.45     25620              TRUE</span></span>
<span><span class="co">#&gt; 3:        0               -0.1 0.95     0.55     25620              TRUE</span></span>
<span><span class="co">#&gt; 4:        0               -0.2 0.95     0.40     25620              TRUE</span></span>
<span><span class="co">#&gt; 5:        0               -0.2 0.95     0.60     25620              TRUE</span></span>
<span><span class="co">#&gt; 6:        0               -0.3 0.95     0.35     25620              TRUE</span></span>
<span></span>
<span><span class="va">scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/summarise_scores.html">summarise_scores</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;    location target_end_date target_type forecast_date                 model</span></span>
<span><span class="co">#&gt; 1:       DE      2021-05-08       Cases    2021-05-03 EuroCOVIDhub-baseline</span></span>
<span><span class="co">#&gt; 2:       DE      2021-05-08       Cases    2021-05-03 EuroCOVIDhub-ensemble</span></span>
<span><span class="co">#&gt; 3:       DE      2021-05-08       Cases    2021-05-03  epiforecasts-EpiNow2</span></span>
<span><span class="co">#&gt; 4:       DE      2021-05-08      Deaths    2021-05-03 EuroCOVIDhub-baseline</span></span>
<span><span class="co">#&gt; 5:       DE      2021-05-08      Deaths    2021-05-03 EuroCOVIDhub-ensemble</span></span>
<span><span class="co">#&gt; 6:       DE      2021-05-08      Deaths    2021-05-03       UMass-MechBayes</span></span>
<span><span class="co">#&gt;    horizon interval_score dispersion underprediction overprediction</span></span>
<span><span class="co">#&gt; 1:       1    16925.04696 1649.22087       0.0000000   15275.826087</span></span>
<span><span class="co">#&gt; 2:       1     7990.85478 5440.98522       0.0000000    2549.869565</span></span>
<span><span class="co">#&gt; 3:       1    25395.96087 8173.70000       0.0000000   17222.260870</span></span>
<span><span class="co">#&gt; 4:       1       46.79304   44.66261       0.0000000       2.130435</span></span>
<span><span class="co">#&gt; 5:       1       53.88000   53.27130       0.6086957       0.000000</span></span>
<span><span class="co">#&gt; 6:       1      116.12174   77.07826      39.0434783       0.000000</span></span>
<span><span class="co">#&gt;    coverage_deviation  bias ae_median</span></span>
<span><span class="co">#&gt; 1:        -0.38521739  0.95     25620</span></span>
<span><span class="co">#&gt; 2:         0.04956522  0.50     12271</span></span>
<span><span class="co">#&gt; 3:        -0.29826087  0.90     44192</span></span>
<span><span class="co">#&gt; 4:         0.22347826  0.30        15</span></span>
<span><span class="co">#&gt; 5:         0.39739130 -0.10        14</span></span>
<span><span class="co">#&gt; 6:         0.04956522 -0.50       208</span></span></code></pre></div>
<p>Through the <code>by</code> argument we can specify what unit of
summary we want. We can also call <code>sumarise_scores()</code>
multiple tines, e.g to round your outputs by specifying
e.g. <code><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif()</a></code> as a summary function.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/summarise_scores.html">summarise_scores</a></span><span class="op">(</span>by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"model"</span>, <span class="st">"target_type"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/summarise_scores.html">summarise_scores</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">signif</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">kable</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="17%">
<col width="9%">
<col width="11%">
<col width="8%">
<col width="12%">
<col width="11%">
<col width="14%">
<col width="6%">
<col width="7%">
</colgroup>
<thead><tr class="header">
<th align="left">model</th>
<th align="left">target_type</th>
<th align="right">interval_score</th>
<th align="right">dispersion</th>
<th align="right">underprediction</th>
<th align="right">overprediction</th>
<th align="right">coverage_deviation</th>
<th align="right">bias</th>
<th align="right">ae_median</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">EuroCOVIDhub-baseline</td>
<td align="left">Cases</td>
<td align="right">28000</td>
<td align="right">4100</td>
<td align="right">10000.0</td>
<td align="right">14000.0</td>
<td align="right">-0.110</td>
<td align="right">0.0980</td>
<td align="right">38000</td>
</tr>
<tr class="even">
<td align="left">EuroCOVIDhub-ensemble</td>
<td align="left">Cases</td>
<td align="right">18000</td>
<td align="right">3700</td>
<td align="right">4200.0</td>
<td align="right">10000.0</td>
<td align="right">-0.098</td>
<td align="right">-0.0560</td>
<td align="right">24000</td>
</tr>
<tr class="odd">
<td align="left">epiforecasts-EpiNow2</td>
<td align="left">Cases</td>
<td align="right">21000</td>
<td align="right">5700</td>
<td align="right">3300.0</td>
<td align="right">12000.0</td>
<td align="right">-0.067</td>
<td align="right">-0.0790</td>
<td align="right">28000</td>
</tr>
<tr class="even">
<td align="left">EuroCOVIDhub-baseline</td>
<td align="left">Deaths</td>
<td align="right">160</td>
<td align="right">91</td>
<td align="right">2.1</td>
<td align="right">66.0</td>
<td align="right">0.120</td>
<td align="right">0.3400</td>
<td align="right">230</td>
</tr>
<tr class="odd">
<td align="left">EuroCOVIDhub-ensemble</td>
<td align="left">Deaths</td>
<td align="right">41</td>
<td align="right">30</td>
<td align="right">4.1</td>
<td align="right">7.1</td>
<td align="right">0.200</td>
<td align="right">0.0730</td>
<td align="right">53</td>
</tr>
<tr class="even">
<td align="left">UMass-MechBayes</td>
<td align="left">Deaths</td>
<td align="right">53</td>
<td align="right">27</td>
<td align="right">17.0</td>
<td align="right">9.0</td>
<td align="right">-0.023</td>
<td align="right">-0.0220</td>
<td align="right">78</td>
</tr>
<tr class="odd">
<td align="left">epiforecasts-EpiNow2</td>
<td align="left">Deaths</td>
<td align="right">67</td>
<td align="right">32</td>
<td align="right">16.0</td>
<td align="right">19.0</td>
<td align="right">-0.043</td>
<td align="right">-0.0051</td>
<td align="right">100</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="scoring-point-forecasts">Scoring point forecasts<a class="anchor" aria-label="anchor" href="#scoring-point-forecasts"></a>
</h3>
<p>Point forecasts can be scored by making use of the quantile-based
format, but with a value of <code>NA</code> or <code>"point"</code> in
the quantile column. Point forecasts can be scored alongside other
quantile-based forecasts. As point forecasts will have values of
<code>NA</code> for metrics designed for probabilistic forecasts, it is
important to use <code>na.rm = TRUE</code> when summarising.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="fu"><a href="../reference/score.html">score</a></span><span class="op">(</span><span class="va">example_point</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/summarise_scores.html">summarise_scores</a></span><span class="op">(</span>by <span class="op">=</span> <span class="st">"model"</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt;                    model interval_score dispersion underprediction</span></span>
<span><span class="co">#&gt; 1: EuroCOVIDhub-baseline     14092.7647 2192.26967      4996.92898</span></span>
<span><span class="co">#&gt; 2: EuroCOVIDhub-ensemble      8852.4196 1930.80064      2005.56357</span></span>
<span><span class="co">#&gt; 3:  epiforecasts-EpiNow2     10659.5125 3084.85850      1604.96135</span></span>
<span><span class="co">#&gt; 4:       UMass-MechBayes        51.4781   28.09387        15.32315</span></span>
<span><span class="co">#&gt;    overprediction coverage_deviation        bias    ae_point     se_point</span></span>
<span><span class="co">#&gt; 1:     6903.56605        0.002102273  0.21851562 19353.42969 2.883446e+09</span></span>
<span><span class="co">#&gt; 2:     4916.05540        0.050752841  0.00812500 12077.10156 1.945118e+09</span></span>
<span><span class="co">#&gt; 3:     5969.69268       -0.057861612 -0.04376518 14521.10526 2.680928e+09</span></span>
<span><span class="co">#&gt; 4:        8.06108       -0.024886364 -0.02312500    78.47656 1.170976e+04</span></span>
<span><span class="co">#&gt;    ae_median</span></span>
<span><span class="co">#&gt; 1:       NaN</span></span>
<span><span class="co">#&gt; 2:       NaN</span></span>
<span><span class="co">#&gt; 3:       NaN</span></span>
<span><span class="co">#&gt; 4:       NaN</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="adding-empirical-coverage">Adding empirical coverage<a class="anchor" aria-label="anchor" href="#adding-empirical-coverage"></a>
</h3>
<p>For quantile-based forecasts we are often interested in specific
coverage-levels, for example, what percentage of true values fell
between all 50% or the 90% prediction intervals. We can add this
information using the function <code><a href="../reference/add_coverage.html">add_coverage()</a></code>. This
function also requires a <code>by</code> argument which defines the
level of grouping for which the percentage of true values covered by
certain prediction intervals is computed.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/score.html">score</a></span><span class="op">(</span><span class="va">example_quantile</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/add_coverage.html">add_coverage</a></span><span class="op">(</span>ranges <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">90</span><span class="op">)</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"model"</span>, <span class="st">"target_type"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/summarise_scores.html">summarise_scores</a></span><span class="op">(</span>by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"model"</span>, <span class="st">"target_type"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/summarise_scores.html">summarise_scores</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">signif</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; The following messages were produced when checking inputs:</span></span>
<span><span class="co">#&gt; 1.  144 values for `prediction` are NA in the data provided and the corresponding rows were removed. This may indicate a problem if unexpected.</span></span>
<span><span class="co">#&gt;                    model target_type interval_score dispersion underprediction</span></span>
<span><span class="co">#&gt; 1: EuroCOVIDhub-baseline       Cases          28000       4100         10000.0</span></span>
<span><span class="co">#&gt; 2: EuroCOVIDhub-baseline      Deaths            160         91             2.1</span></span>
<span><span class="co">#&gt; 3: EuroCOVIDhub-ensemble       Cases          18000       3700          4200.0</span></span>
<span><span class="co">#&gt; 4: EuroCOVIDhub-ensemble      Deaths             41         30             4.1</span></span>
<span><span class="co">#&gt; 5:       UMass-MechBayes      Deaths             53         27            17.0</span></span>
<span><span class="co">#&gt; 6:  epiforecasts-EpiNow2       Cases          21000       5700          3300.0</span></span>
<span><span class="co">#&gt; 7:  epiforecasts-EpiNow2      Deaths             67         32            16.0</span></span>
<span><span class="co">#&gt;    overprediction coverage_deviation    bias ae_median coverage_50 coverage_90</span></span>
<span><span class="co">#&gt; 1:        14000.0             -0.110  0.0980     38000        0.33        0.82</span></span>
<span><span class="co">#&gt; 2:           66.0              0.120  0.3400       230        0.66        1.00</span></span>
<span><span class="co">#&gt; 3:        10000.0             -0.098 -0.0560     24000        0.39        0.80</span></span>
<span><span class="co">#&gt; 4:            7.1              0.200  0.0730        53        0.88        1.00</span></span>
<span><span class="co">#&gt; 5:            9.0             -0.023 -0.0220        78        0.46        0.88</span></span>
<span><span class="co">#&gt; 6:        12000.0             -0.067 -0.0790     28000        0.47        0.79</span></span>
<span><span class="co">#&gt; 7:           19.0             -0.043 -0.0051       100        0.42        0.91</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="adding-relative-scores">Adding relative scores<a class="anchor" aria-label="anchor" href="#adding-relative-scores"></a>
</h3>
<p>In order to better compare models against each other we can use
relative scores which are computed based on pairwise comparisons (see
details below). Relative scores can be added to the evaluation using the
function <code><a href="../reference/summarise_scores.html">summarise_scores()</a></code>. This requires a column called
‘model’ to be present. Pairwise comparisons are computed according to
the grouping specified in <code>by</code>: essentially, the data.frame
with all scores gets split into different data.frames according to the
values specified in <code>by</code> and relative scores are computed for
every individual group separately. The <code>baseline</code> argument
allows us to specify a baseline that can be used to scale relative
scores (all scores are divided by the baseline relative score). For
example, to obtain relative scores separately for different forecast
targets, we can run</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/score.html">score</a></span><span class="op">(</span><span class="va">example_quantile</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/summarise_scores.html">summarise_scores</a></span><span class="op">(</span>by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"model"</span>, <span class="st">"target_type"</span><span class="op">)</span>,</span>
<span>                   relative_skill <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                   baseline <span class="op">=</span> <span class="st">"EuroCOVIDhub-ensemble"</span><span class="op">)</span></span>
<span><span class="co">#&gt; The following messages were produced when checking inputs:</span></span>
<span><span class="co">#&gt; 1.  144 values for `prediction` are NA in the data provided and the corresponding rows were removed. This may indicate a problem if unexpected.</span></span>
<span><span class="co">#&gt;                    model target_type interval_score dispersion underprediction</span></span>
<span><span class="co">#&gt; 1: EuroCOVIDhub-baseline       Cases    28483.57465 4102.50094    10284.972826</span></span>
<span><span class="co">#&gt; 2: EuroCOVIDhub-baseline      Deaths      159.40387   91.40625        2.098505</span></span>
<span><span class="co">#&gt; 3: EuroCOVIDhub-ensemble       Cases    17943.82383 3663.52458     4237.177310</span></span>
<span><span class="co">#&gt; 4: EuroCOVIDhub-ensemble      Deaths       41.42249   30.18099        4.103261</span></span>
<span><span class="co">#&gt; 5:       UMass-MechBayes      Deaths       52.65195   26.87239       16.800951</span></span>
<span><span class="co">#&gt; 6:  epiforecasts-EpiNow2       Cases    20831.55662 5664.37795     3260.355639</span></span>
<span><span class="co">#&gt; 7:  epiforecasts-EpiNow2      Deaths       66.64282   31.85692       15.893314</span></span>
<span><span class="co">#&gt;    overprediction coverage_deviation        bias   ae_median relative_skill</span></span>
<span><span class="co">#&gt; 1:   14096.100883        -0.11211957  0.09796875 38473.60156      1.2947445</span></span>
<span><span class="co">#&gt; 2:      65.899117         0.11614130  0.33906250   233.25781      2.2958723</span></span>
<span><span class="co">#&gt; 3:   10043.121943        -0.09785326 -0.05640625 24101.07031      0.8156514</span></span>
<span><span class="co">#&gt; 4:       7.138247         0.19528533  0.07265625    53.13281      0.5966310</span></span>
<span><span class="co">#&gt; 5:       8.978601        -0.02312500 -0.02234375    78.47656      0.7475873</span></span>
<span><span class="co">#&gt; 6:   11906.823030        -0.06660326 -0.07890625 27923.81250      0.9469157</span></span>
<span><span class="co">#&gt; 7:      18.892583        -0.04287176 -0.00512605   104.74790      0.9765276</span></span>
<span><span class="co">#&gt;    scaled_rel_skill</span></span>
<span><span class="co">#&gt; 1:         1.587375</span></span>
<span><span class="co">#&gt; 2:         3.848060</span></span>
<span><span class="co">#&gt; 3:         1.000000</span></span>
<span><span class="co">#&gt; 4:         1.000000</span></span>
<span><span class="co">#&gt; 5:         1.253014</span></span>
<span><span class="co">#&gt; 6:         1.160932</span></span>
<span><span class="co">#&gt; 7:         1.636736</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="visualising-scores">Visualising scores<a class="anchor" aria-label="anchor" href="#visualising-scores"></a>
</h2>
<div class="section level3">
<h3 id="coloured-table">Coloured table<a class="anchor" aria-label="anchor" href="#coloured-table"></a>
</h3>
<p>A simple coloured table can be produced based on the scores:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/score.html">score</a></span><span class="op">(</span><span class="va">example_integer</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/summarise_scores.html">summarise_scores</a></span><span class="op">(</span>by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"model"</span>, <span class="st">"target_type"</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/summarise_scores.html">summarise_scores</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">signif</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/plot_score_table.html">plot_score_table</a></span><span class="op">(</span>by <span class="op">=</span> <span class="st">"target_type"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">target_type</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; The following messages were produced when checking inputs:</span></span>
<span><span class="co">#&gt; 1.  144 values for `prediction` are NA in the data provided and the corresponding rows were removed. This may indicate a problem if unexpected.</span></span></code></pre></div>
<p><img src="scoringutils_files/figure-html/unnamed-chunk-18-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="score-heatmap">Score heatmap<a class="anchor" aria-label="anchor" href="#score-heatmap"></a>
</h3>
<p>We can also summarise one particular metric across different
categories using a simple heatmap:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/score.html">score</a></span><span class="op">(</span><span class="va">example_continuous</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/summarise_scores.html">summarise_scores</a></span><span class="op">(</span>by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"model"</span>, <span class="st">"location"</span>, <span class="st">"target_type"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/plot_heatmap.html">plot_heatmap</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"location"</span>, metric <span class="op">=</span> <span class="st">"bias"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">target_type</span><span class="op">)</span></span>
<span><span class="co">#&gt; The following messages were produced when checking inputs:</span></span>
<span><span class="co">#&gt; 1.  144 values for `prediction` are NA in the data provided and the corresponding rows were removed. This may indicate a problem if unexpected.</span></span></code></pre></div>
<p><img src="scoringutils_files/figure-html/unnamed-chunk-19-1.png" width="1056"></p>
</div>
<div class="section level3">
<h3 id="weighted-interval-score-components">Weighted interval score components<a class="anchor" aria-label="anchor" href="#weighted-interval-score-components"></a>
</h3>
<p>The weighted interval score can be split up into three components:
Over-prediction, under-prediction and dispersion. These can be
visualised separately in the following way:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/score.html">score</a></span><span class="op">(</span><span class="va">example_quantile</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/summarise_scores.html">summarise_scores</a></span><span class="op">(</span>by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"target_type"</span>, <span class="st">"model"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/plot_wis.html">plot_wis</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">target_type</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span>
<span><span class="co">#&gt; The following messages were produced when checking inputs:</span></span>
<span><span class="co">#&gt; 1.  144 values for `prediction` are NA in the data provided and the corresponding rows were removed. This may indicate a problem if unexpected.</span></span></code></pre></div>
<p><img src="scoringutils_files/figure-html/unnamed-chunk-20-1.png" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="calibration">Calibration<a class="anchor" aria-label="anchor" href="#calibration"></a>
</h2>
<p>Calibration is a measure statistical consistency between the
forecasts and the observed values. The most common way of assessing
calibration (more precisely: probabilistic calibration) are PIT
histograms. The probability integral transform (PIT) is equal to the
cumulative distribution function of a forecast evaluated at the true
observed value. Ideally, pit values should be uniformly distributed
after the transformation.</p>
<p>We can compute pit values as such:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_continuous</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/pit.html">pit</a></span><span class="op">(</span>by <span class="op">=</span> <span class="st">"model"</span><span class="op">)</span></span>
<span><span class="co">#&gt; The following messages were produced when checking inputs:</span></span>
<span><span class="co">#&gt; 1.  144 values for `prediction` are NA in the data provided and the corresponding rows were removed. This may indicate a problem if unexpected.</span></span>
<span><span class="co">#&gt;                      model pit_value</span></span>
<span><span class="co">#&gt;   1: EuroCOVIDhub-baseline     0.025</span></span>
<span><span class="co">#&gt;   2: EuroCOVIDhub-baseline     0.525</span></span>
<span><span class="co">#&gt;   3: EuroCOVIDhub-baseline     0.000</span></span>
<span><span class="co">#&gt;   4: EuroCOVIDhub-baseline     0.000</span></span>
<span><span class="co">#&gt;   5: EuroCOVIDhub-baseline     0.200</span></span>
<span><span class="co">#&gt;  ---                                </span></span>
<span><span class="co">#&gt; 883:       UMass-MechBayes     0.950</span></span>
<span><span class="co">#&gt; 884:       UMass-MechBayes     0.500</span></span>
<span><span class="co">#&gt; 885:       UMass-MechBayes     0.100</span></span>
<span><span class="co">#&gt; 886:       UMass-MechBayes     0.450</span></span>
<span><span class="co">#&gt; 887:       UMass-MechBayes     0.100</span></span></code></pre></div>
<p>And visualise the results as such:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_continuous</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/pit.html">pit</a></span><span class="op">(</span>by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"model"</span>, <span class="st">"target_type"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/plot_pit.html">plot_pit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">model</span> <span class="op">~</span> <span class="va">target_type</span><span class="op">)</span></span>
<span><span class="co">#&gt; The following messages were produced when checking inputs:</span></span>
<span><span class="co">#&gt; 1.  144 values for `prediction` are NA in the data provided and the corresponding rows were removed. This may indicate a problem if unexpected.</span></span></code></pre></div>
<p><img src="scoringutils_files/figure-html/unnamed-chunk-22-1.png" width="672"></p>
<p>Similarly for quantile-based forecasts:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_quantile</span><span class="op">[</span><span class="va">quantile</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="fl">0.1</span><span class="op">)</span>, <span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/pit.html">pit</a></span><span class="op">(</span>by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"model"</span>, <span class="st">"target_type"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/plot_pit.html">plot_pit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">model</span> <span class="op">~</span> <span class="va">target_type</span><span class="op">)</span></span></code></pre></div>
<p><img src="scoringutils_files/figure-html/unnamed-chunk-23-1.png" width="672"></p>
<p>Another way to look at calibration are interval coverage and quantile
coverage. Interval coverage is the percentage of true values that fall
inside a given central prediction interval. Quantile coverage is the
percentage of observed values that fall below a given quantile
level.</p>
<p>In order to plot interval coverage, you need to include “range” in
the <code>by</code> argument to <code><a href="../reference/summarise_scores.html">summarise_scores()</a></code>. The
green area on the plot marks conservative behaviour, i.e. your empirical
coverage is greater than it nominally need be (e.g. 55% of true values
covered by all 50% central prediction intervals.)</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_quantile</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/score.html">score</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/summarise_scores.html">summarise_scores</a></span><span class="op">(</span>by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"model"</span>, <span class="st">"range"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/plot_interval_coverage.html">plot_interval_coverage</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; The following messages were produced when checking inputs:</span></span>
<span><span class="co">#&gt; 1.  144 values for `prediction` are NA in the data provided and the corresponding rows were removed. This may indicate a problem if unexpected.</span></span></code></pre></div>
<p><img src="scoringutils_files/figure-html/unnamed-chunk-24-1.png" width="672"></p>
<p>To visualise quantile coverage, you need to include “quantile” in
<code>by</code>. Again, the green area corresponds to conservative
forecasts, where central prediction intervals would cover more than
needed.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_quantile</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/score.html">score</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/summarise_scores.html">summarise_scores</a></span><span class="op">(</span>by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"model"</span>, <span class="st">"quantile"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/plot_quantile_coverage.html">plot_quantile_coverage</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; The following messages were produced when checking inputs:</span></span>
<span><span class="co">#&gt; 1.  144 values for `prediction` are NA in the data provided and the corresponding rows were removed. This may indicate a problem if unexpected.</span></span></code></pre></div>
<p><img src="scoringutils_files/figure-html/unnamed-chunk-25-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="pairwise-comparisons">Pairwise comparisons<a class="anchor" aria-label="anchor" href="#pairwise-comparisons"></a>
</h2>
<p>Relative scores for different models can be computed using pairwise
comparisons, a sort of pairwise tournament where all combinations of two
models are compared against each other based on the overlapping set of
available forecasts common to both models. Internally, a ratio of the
mean scores of both models is computed. The relative score of a model is
then the geometric mean of all mean score ratios which involve that
model. When a baseline is provided, then that baseline is excluded from
the relative scores for individual models (which therefore differ
slightly from relative scores without a baseline) and all relative
scores are scaled by (i.e. divided by) the relative score of the
baseline model.</p>
<p>In <code>scoringutils</code>, pairwise comparisons can be made in two
ways: Through the standalone function <code><a href="../reference/pairwise_comparison.html">pairwise_comparison()</a></code>
or from within <code><a href="../reference/summarise_scores.html">summarise_scores()</a></code> which simply adds
relative scores to an existing set of scores.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_quantile</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/score.html">score</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/pairwise_comparison.html">pairwise_comparison</a></span><span class="op">(</span>by <span class="op">=</span> <span class="st">"model"</span>, baseline <span class="op">=</span> <span class="st">"EuroCOVIDhub-baseline"</span><span class="op">)</span></span>
<span><span class="co">#&gt; The following messages were produced when checking inputs:</span></span>
<span><span class="co">#&gt; 1.  144 values for `prediction` are NA in the data provided and the corresponding rows were removed. This may indicate a problem if unexpected.</span></span>
<span><span class="co">#&gt;                     model       compare_against mean_scores_ratio         pval</span></span>
<span><span class="co">#&gt;  1: EuroCOVIDhub-baseline  epiforecasts-EpiNow2         1.3703452 9.164893e-18</span></span>
<span><span class="co">#&gt;  2: EuroCOVIDhub-baseline EuroCOVIDhub-ensemble         1.5925819 2.608666e-32</span></span>
<span><span class="co">#&gt;  3: EuroCOVIDhub-baseline       UMass-MechBayes         3.0275019 2.627464e-20</span></span>
<span><span class="co">#&gt;  4: EuroCOVIDhub-baseline EuroCOVIDhub-baseline         1.0000000 1.000000e+00</span></span>
<span><span class="co">#&gt;  5: EuroCOVIDhub-ensemble       UMass-MechBayes         0.7867229 1.244731e-04</span></span>
<span><span class="co">#&gt;  6: EuroCOVIDhub-ensemble  epiforecasts-EpiNow2         0.8606607 1.881520e-02</span></span>
<span><span class="co">#&gt;  7: EuroCOVIDhub-ensemble EuroCOVIDhub-baseline         0.6279112 2.608666e-32</span></span>
<span><span class="co">#&gt;  8: EuroCOVIDhub-ensemble EuroCOVIDhub-ensemble         1.0000000 1.000000e+00</span></span>
<span><span class="co">#&gt;  9:       UMass-MechBayes EuroCOVIDhub-ensemble         1.2710955 1.244731e-04</span></span>
<span><span class="co">#&gt; 10:       UMass-MechBayes  epiforecasts-EpiNow2         0.7439673 7.253878e-03</span></span>
<span><span class="co">#&gt; 11:       UMass-MechBayes EuroCOVIDhub-baseline         0.3303053 2.627464e-20</span></span>
<span><span class="co">#&gt; 12:       UMass-MechBayes       UMass-MechBayes         1.0000000 1.000000e+00</span></span>
<span><span class="co">#&gt; 13:  epiforecasts-EpiNow2       UMass-MechBayes         1.3441452 7.253878e-03</span></span>
<span><span class="co">#&gt; 14:  epiforecasts-EpiNow2 EuroCOVIDhub-ensemble         1.1618981 1.881520e-02</span></span>
<span><span class="co">#&gt; 15:  epiforecasts-EpiNow2 EuroCOVIDhub-baseline         0.7297431 9.164893e-18</span></span>
<span><span class="co">#&gt; 16:  epiforecasts-EpiNow2  epiforecasts-EpiNow2         1.0000000 1.000000e+00</span></span>
<span><span class="co">#&gt;         adj_pval relative_skill scaled_rel_skill</span></span>
<span><span class="co">#&gt;  1: 3.665957e-17      1.6032604        1.0000000</span></span>
<span><span class="co">#&gt;  2: 1.565200e-31      1.6032604        1.0000000</span></span>
<span><span class="co">#&gt;  3: 1.313732e-19      1.6032604        1.0000000</span></span>
<span><span class="co">#&gt;  4: 1.000000e+00      1.6032604        1.0000000</span></span>
<span><span class="co">#&gt;  5: 3.734192e-04      0.8074916        0.5036559</span></span>
<span><span class="co">#&gt;  6: 1.881520e-02      0.8074916        0.5036559</span></span>
<span><span class="co">#&gt;  7: 1.565200e-31      0.8074916        0.5036559</span></span>
<span><span class="co">#&gt;  8: 1.000000e+00      0.8074916        0.5036559</span></span>
<span><span class="co">#&gt;  9: 3.734192e-04      0.7475873        0.4662919</span></span>
<span><span class="co">#&gt; 10: 1.450776e-02      0.7475873        0.4662919</span></span>
<span><span class="co">#&gt; 11: 1.313732e-19      0.7475873        0.4662919</span></span>
<span><span class="co">#&gt; 12: 1.000000e+00      0.7475873        0.4662919</span></span>
<span><span class="co">#&gt; 13: 1.450776e-02      1.0332277        0.6444541</span></span>
<span><span class="co">#&gt; 14: 1.881520e-02      1.0332277        0.6444541</span></span>
<span><span class="co">#&gt; 15: 3.665957e-17      1.0332277        0.6444541</span></span>
<span><span class="co">#&gt; 16: 1.000000e+00      1.0332277        0.6444541</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_quantile</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/score.html">score</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/summarise_scores.html">summarise_scores</a></span><span class="op">(</span></span>
<span>    by <span class="op">=</span> <span class="st">"model"</span>, relative_skill <span class="op">=</span> <span class="cn">TRUE</span>, baseline <span class="op">=</span> <span class="st">"EuroCOVIDhub-baseline"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; The following messages were produced when checking inputs:</span></span>
<span><span class="co">#&gt; 1.  144 values for `prediction` are NA in the data provided and the corresponding rows were removed. This may indicate a problem if unexpected.</span></span>
<span><span class="co">#&gt;                    model interval_score dispersion underprediction</span></span>
<span><span class="co">#&gt; 1: EuroCOVIDhub-baseline    14321.48926 2096.95360      5143.53567</span></span>
<span><span class="co">#&gt; 2: EuroCOVIDhub-ensemble     8992.62316 1846.85278      2120.64029</span></span>
<span><span class="co">#&gt; 3:       UMass-MechBayes       52.65195   26.87239        16.80095</span></span>
<span><span class="co">#&gt; 4:  epiforecasts-EpiNow2    10827.40786 2950.73422      1697.23411</span></span>
<span><span class="co">#&gt;    overprediction coverage_deviation        bias   ae_median relative_skill</span></span>
<span><span class="co">#&gt; 1:    7081.000000         0.00201087  0.21851562 19353.42969      1.6032604</span></span>
<span><span class="co">#&gt; 2:    5025.130095         0.04871603  0.00812500 12077.10156      0.8074916</span></span>
<span><span class="co">#&gt; 3:       8.978601        -0.02312500 -0.02234375    78.47656      0.7475873</span></span>
<span><span class="co">#&gt; 4:    6179.439535        -0.05516986 -0.04336032 14521.10526      1.0332277</span></span>
<span><span class="co">#&gt;    scaled_rel_skill</span></span>
<span><span class="co">#&gt; 1:        1.0000000</span></span>
<span><span class="co">#&gt; 2:        0.5036559</span></span>
<span><span class="co">#&gt; 3:        0.4662919</span></span>
<span><span class="co">#&gt; 4:        0.6444541</span></span></code></pre></div>
<p>If using the <code><a href="../reference/pairwise_comparison.html">pairwise_comparison()</a></code> function, we can also
visualise pairwise comparisons by showing the mean score ratios between
models. By default, smaller values are better and the model we care
about is showing on the y axis on the left, while the model against it
is compared is shown on the x-axis on the bottom. In the example above,
the EuroCOVIDhub-ensemble performs best (it only has values smaller 1),
while the EuroCOVIDhub-baseline performs worst (and only has values
larger than 1). For cases, the UMass-MechBayes model is of course
excluded as there are no case forecasts available and therefore the set
of overlapping forecasts is empty.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_quantile</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/score.html">score</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/pairwise_comparison.html">pairwise_comparison</a></span><span class="op">(</span>by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"model"</span>, <span class="st">"target_type"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/plot_pairwise_comparison.html">plot_pairwise_comparison</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">target_type</span><span class="op">)</span></span>
<span><span class="co">#&gt; The following messages were produced when checking inputs:</span></span>
<span><span class="co">#&gt; 1.  144 values for `prediction` are NA in the data provided and the corresponding rows were removed. This may indicate a problem if unexpected.</span></span></code></pre></div>
<p><img src="scoringutils_files/figure-html/unnamed-chunk-28-1.png" width="864"></p>
</div>
<div class="section level2">
<h2 id="additional-analyses-and-visualisations">Additional analyses and visualisations<a class="anchor" aria-label="anchor" href="#additional-analyses-and-visualisations"></a>
</h2>
<div class="section level3">
<h3 id="correlation-between-scores">Correlation between scores<a class="anchor" aria-label="anchor" href="#correlation-between-scores"></a>
</h3>
<p>It may sometimes be interesting to see how different scores correlate
with each other. We can examine this using the function
<code><a href="../reference/correlation.html">correlation()</a></code>. When dealing with quantile-based forecasts,
it is important to call <code>summarise_scorees()</code> before
<code><a href="../reference/correlation.html">correlation()</a></code> to summarise over quantiles before computing
correlations.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_quantile</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/score.html">score</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/summarise_scores.html">summarise_scores</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/correlation.html">correlation</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; The following messages were produced when checking inputs:</span></span>
<span><span class="co">#&gt; 1.  144 values for `prediction` are NA in the data provided and the corresponding rows were removed. This may indicate a problem if unexpected.</span></span>
<span><span class="co">#&gt;    interval_score dispersion underprediction overprediction coverage_deviation</span></span>
<span><span class="co">#&gt; 1:           1.00       0.46            0.28           0.94              -0.34</span></span>
<span><span class="co">#&gt; 2:           0.46       1.00            0.15           0.32              -0.12</span></span>
<span><span class="co">#&gt; 3:           0.28       0.15            1.00          -0.03              -0.33</span></span>
<span><span class="co">#&gt; 4:           0.94       0.32           -0.03           1.00              -0.25</span></span>
<span><span class="co">#&gt; 5:          -0.34      -0.12           -0.33          -0.25               1.00</span></span>
<span><span class="co">#&gt; 6:           0.11       0.11           -0.35           0.22               0.06</span></span>
<span><span class="co">#&gt; 7:           0.99       0.54            0.34           0.90              -0.38</span></span>
<span><span class="co">#&gt;     bias ae_median             metric</span></span>
<span><span class="co">#&gt; 1:  0.11      0.99     interval_score</span></span>
<span><span class="co">#&gt; 2:  0.11      0.54         dispersion</span></span>
<span><span class="co">#&gt; 3: -0.35      0.34    underprediction</span></span>
<span><span class="co">#&gt; 4:  0.22      0.90     overprediction</span></span>
<span><span class="co">#&gt; 5:  0.06     -0.38 coverage_deviation</span></span>
<span><span class="co">#&gt; 6:  1.00      0.10               bias</span></span>
<span><span class="co">#&gt; 7:  0.10      1.00          ae_median</span></span></code></pre></div>
<p>Visualising correlations:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_quantile</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/score.html">score</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/summarise_scores.html">summarise_scores</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/correlation.html">correlation</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/plot_correlation.html">plot_correlation</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; The following messages were produced when checking inputs:</span></span>
<span><span class="co">#&gt; 1.  144 values for `prediction` are NA in the data provided and the corresponding rows were removed. This may indicate a problem if unexpected.</span></span></code></pre></div>
<p><img src="scoringutils_files/figure-html/unnamed-chunk-30-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="scores-by-interval-ranges">Scores by interval ranges<a class="anchor" aria-label="anchor" href="#scores-by-interval-ranges"></a>
</h3>
<p>If you would like to see how different forecast interval ranges
contribute to average scores, you can visualise scores by interval
range:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_quantile</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/score.html">score</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/summarise_scores.html">summarise_scores</a></span><span class="op">(</span>by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"model"</span>, <span class="st">"range"</span>, <span class="st">"target_type"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/plot_ranges.html">plot_ranges</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">target_type</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span>
<span><span class="co">#&gt; The following messages were produced when checking inputs:</span></span>
<span><span class="co">#&gt; 1.  144 values for `prediction` are NA in the data provided and the corresponding rows were removed. This may indicate a problem if unexpected.</span></span></code></pre></div>
<p><img src="scoringutils_files/figure-html/unnamed-chunk-31-1.png" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="converting-to-quantile-based-forecasts">Converting to quantile-based forecasts<a class="anchor" aria-label="anchor" href="#converting-to-quantile-based-forecasts"></a>
</h2>
<p>Different metrics are available for different forecasting formats. In
some cases, you may for example have forecasts in a sample-based format,
but wish to make use of some of the functionality only available to
quantile-based forecasts. For example, you may want to use the
decomposition of the weighted interval score, or may like to compute
interval coverage values.</p>
<p>You can convert your sample-based forecasts into a quantile-based
format using the function <code><a href="../reference/sample_to_quantile.html">sample_to_quantile()</a></code>. There is,
however, one caveat: Quantiles will be calculated based on the
predictive samples, which may introduce a bias if the number of
available samples is small.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_integer</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/sample_to_quantile.html">sample_to_quantile</a></span><span class="op">(</span></span>
<span>    quantiles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.025</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="fl">0.05</span><span class="op">)</span>, <span class="fl">0.975</span>, <span class="fl">0.99</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/score.html">score</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/add_coverage.html">add_coverage</a></span><span class="op">(</span>by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"model"</span>, <span class="st">"target_type"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; The following messages were produced when checking inputs:</span></span>
<span><span class="co">#&gt; 1.  3312 values for `prediction` are NA in the data provided and the corresponding rows were removed. This may indicate a problem if unexpected.</span></span>
<span><span class="co">#&gt;                        model target_type location location_name target_end_date</span></span>
<span><span class="co">#&gt;     1: EuroCOVIDhub-baseline       Cases       DE       Germany      2021-05-08</span></span>
<span><span class="co">#&gt;     2: EuroCOVIDhub-baseline       Cases       DE       Germany      2021-05-08</span></span>
<span><span class="co">#&gt;     3: EuroCOVIDhub-baseline       Cases       DE       Germany      2021-05-08</span></span>
<span><span class="co">#&gt;     4: EuroCOVIDhub-baseline       Cases       DE       Germany      2021-05-08</span></span>
<span><span class="co">#&gt;     5: EuroCOVIDhub-baseline       Cases       DE       Germany      2021-05-08</span></span>
<span><span class="co">#&gt;    ---                                                                         </span></span>
<span><span class="co">#&gt; 20397:  epiforecasts-EpiNow2      Deaths       IT         Italy      2021-07-24</span></span>
<span><span class="co">#&gt; 20398:  epiforecasts-EpiNow2      Deaths       IT         Italy      2021-07-24</span></span>
<span><span class="co">#&gt; 20399:  epiforecasts-EpiNow2      Deaths       IT         Italy      2021-07-24</span></span>
<span><span class="co">#&gt; 20400:  epiforecasts-EpiNow2      Deaths       IT         Italy      2021-07-24</span></span>
<span><span class="co">#&gt; 20401:  epiforecasts-EpiNow2      Deaths       IT         Italy      2021-07-24</span></span>
<span><span class="co">#&gt;        forecast_date horizon range interval_score dispersion underprediction</span></span>
<span><span class="co">#&gt;     1:    2021-05-03       1     0    29379.00000    0.00000               0</span></span>
<span><span class="co">#&gt;     2:    2021-05-03       1    10    27857.47500 3012.07500               0</span></span>
<span><span class="co">#&gt;     3:    2021-05-03       1    10    27857.47500 3012.07500               0</span></span>
<span><span class="co">#&gt;     4:    2021-05-03       1    20    26443.96000 4109.76000               0</span></span>
<span><span class="co">#&gt;     5:    2021-05-03       1    20    26443.96000 4109.76000               0</span></span>
<span><span class="co">#&gt;    ---                                                                      </span></span>
<span><span class="co">#&gt; 20397:    2021-07-12       2    90       21.21000   21.21000               0</span></span>
<span><span class="co">#&gt; 20398:    2021-07-12       2    95       15.00563   15.00563               0</span></span>
<span><span class="co">#&gt; 20399:    2021-07-12       2    95       15.00563   15.00563               0</span></span>
<span><span class="co">#&gt; 20400:    2021-07-12       2    98        6.28890    6.28890               0</span></span>
<span><span class="co">#&gt; 20401:    2021-07-12       2    98        6.28890    6.28890               0</span></span>
<span><span class="co">#&gt;        overprediction coverage coverage_deviation bias quantile ae_median</span></span>
<span><span class="co">#&gt;     1:        29379.0        0               0.00 0.98    0.500   29379.0</span></span>
<span><span class="co">#&gt;     2:        24845.4        0              -0.10 0.98    0.450   29379.0</span></span>
<span><span class="co">#&gt;     3:        24845.4        0              -0.10 0.98    0.550   29379.0</span></span>
<span><span class="co">#&gt;     4:        22334.2        0              -0.20 0.98    0.400   29379.0</span></span>
<span><span class="co">#&gt;     5:        22334.2        0              -0.20 0.98    0.600   29379.0</span></span>
<span><span class="co">#&gt;    ---                                                                   </span></span>
<span><span class="co">#&gt; 20397:            0.0        1               0.10 0.70    0.950      73.5</span></span>
<span><span class="co">#&gt; 20398:            0.0        1               0.05 0.70    0.025      73.5</span></span>
<span><span class="co">#&gt; 20399:            0.0        1               0.05 0.70    0.975      73.5</span></span>
<span><span class="co">#&gt; 20400:            0.0        1               0.02 0.70    0.010      73.5</span></span>
<span><span class="co">#&gt; 20401:            0.0        1               0.02 0.70    0.990      73.5</span></span>
<span><span class="co">#&gt;        quantile_coverage coverage_50 coverage_90</span></span>
<span><span class="co">#&gt;     1:              TRUE   0.3828125   0.7265625</span></span>
<span><span class="co">#&gt;     2:              TRUE   0.3828125   0.7265625</span></span>
<span><span class="co">#&gt;     3:              TRUE   0.3828125   0.7265625</span></span>
<span><span class="co">#&gt;     4:              TRUE   0.3828125   0.7265625</span></span>
<span><span class="co">#&gt;     5:              TRUE   0.3828125   0.7265625</span></span>
<span><span class="co">#&gt;    ---                                          </span></span>
<span><span class="co">#&gt; 20397:              TRUE   0.5462185   0.9243697</span></span>
<span><span class="co">#&gt; 20398:             FALSE   0.5462185   0.9243697</span></span>
<span><span class="co">#&gt; 20399:              TRUE   0.5462185   0.9243697</span></span>
<span><span class="co">#&gt; 20400:             FALSE   0.5462185   0.9243697</span></span>
<span><span class="co">#&gt; 20401:              TRUE   0.5462185   0.9243697</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="available-metrics">Available metrics<a class="anchor" aria-label="anchor" href="#available-metrics"></a>
</h2>
<p>An overview of available metrics can be found in the
<code>metrics</code> data set that is included in the package.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">metrics</span></span>
<span><span class="co">#&gt;                                           Metric               Name</span></span>
<span><span class="co">#&gt;  1:                               Absolute error           ae_point</span></span>
<span><span class="co">#&gt;  2:                               Absolute error          ae_median</span></span>
<span><span class="co">#&gt;  3:                                Squared error           se_point</span></span>
<span><span class="co">#&gt;  4:                                Squared error            se_mean</span></span>
<span><span class="co">#&gt;  5: (Continuous) ranked probability score (CRPS)               crps</span></span>
<span><span class="co">#&gt;  6:                                    Log score          log_score</span></span>
<span><span class="co">#&gt;  7:              (Weighted) interval score (WIS)     interval_score</span></span>
<span><span class="co">#&gt;  8:                 Dawid-Sebastiani score (DSS)                dss</span></span>
<span><span class="co">#&gt;  9:                             Brier score (BS)        brier_score</span></span>
<span><span class="co">#&gt; 10:                            Interval coverage           coverage</span></span>
<span><span class="co">#&gt; 11:                           Coverage deviation coverage_deviation</span></span>
<span><span class="co">#&gt; 12:                            Quantile coverage  quantile_coverage</span></span>
<span><span class="co">#&gt; 13:                                   Dispersion         dispersion</span></span>
<span><span class="co">#&gt; 14:       Median Absolute Deviation (Dispersion)                mad</span></span>
<span><span class="co">#&gt; 15:                      Under-, Over-prediction    underprediction</span></span>
<span><span class="co">#&gt; 16:                      Under-, Over-prediction     overprediction</span></span>
<span><span class="co">#&gt; 17:         Probability integral transform (PIT)               crps</span></span>
<span><span class="co">#&gt; 18:                                   Dispersion         dispersion</span></span>
<span><span class="co">#&gt; 19:                                         Bias               bias</span></span>
<span><span class="co">#&gt; 20:                             Mean score ratio  mean_scores_ratio</span></span>
<span><span class="co">#&gt; 21:                               Relative skill     relative_skill</span></span>
<span><span class="co">#&gt; 22:                        Scaled relative skill   scaled_rel_skill</span></span>
<span><span class="co">#&gt;                                           Metric               Name</span></span>
<span><span class="co">#&gt;                                   Functions Discrete Continuous Binary Quantile</span></span>
<span><span class="co">#&gt;  1: score(), ae_point()), ae_median_sample(        +          +      -        +</span></span>
<span><span class="co">#&gt;  2: score(), ae_point()), ae_median_sample(        +          +      -        +</span></span>
<span><span class="co">#&gt;  3:   score(), se_point(), se_mean_sample()        +          +      -        +</span></span>
<span><span class="co">#&gt;  4:   score(), se_point(), se_mean_sample()        +          +      -        +</span></span>
<span><span class="co">#&gt;  5:                       score(), ae_point        +          +      -        -</span></span>
<span><span class="co">#&gt;  6:   score(), logs_sample(), logs_binary()        -          +      +        -</span></span>
<span><span class="co">#&gt;  7:               score(), interval_score()        +          +      -        +</span></span>
<span><span class="co">#&gt;  8:                   score(), dss_sample()        +          +      -        -</span></span>
<span><span class="co">#&gt;  9:                  score(), brier_score()        -          -      +        -</span></span>
<span><span class="co">#&gt; 10:                                 score()        -          -      -        +</span></span>
<span><span class="co">#&gt; 11:                                 score()        -          -      -        +</span></span>
<span><span class="co">#&gt; 12:                                 score()        +          +      -        -</span></span>
<span><span class="co">#&gt; 13:               score(), interval_score()        -          -      -        +</span></span>
<span><span class="co">#&gt; 14:                   score(), mad_sample()        +          +      -        -</span></span>
<span><span class="co">#&gt; 15:               score(), interval_score()        -          -      -        +</span></span>
<span><span class="co">#&gt; 16:               score(), interval_score()        -          -      -        +</span></span>
<span><span class="co">#&gt; 17:                          score(), pit()        +          +      -        +</span></span>
<span><span class="co">#&gt; 18:               score(), interval_score()        -          -      -        +</span></span>
<span><span class="co">#&gt; 19: score(), bias_sample(), bias_quantile()        +          +      -        +</span></span>
<span><span class="co">#&gt; 20:                   pairwise_comparison()        ~          ~      ~        ~</span></span>
<span><span class="co">#&gt; 21:          score(), pairwise_comparison()        ~          ~      ~        ~</span></span>
<span><span class="co">#&gt; 22:          score(), pairwise_comparison()        ~          ~      ~        ~</span></span>
<span><span class="co">#&gt;                                   Functions Discrete Continuous Binary Quantile</span></span>
<span><span class="co">#&gt;                                                                                                                                                                                                           Info</span></span>
<span><span class="co">#&gt;  1:                                                                                                                                               Suitable for scoring the median of a predictive distribution</span></span>
<span><span class="co">#&gt;  2:                                                                                                                                               Suitable for scoring the median of a predictive distribution</span></span>
<span><span class="co">#&gt;  3:                                                                                                                                                Suitable for scoring the mean of a predictive distribution.</span></span>
<span><span class="co">#&gt;  4:                                                                                                                                                Suitable for scoring the mean of a predictive distribution.</span></span>
<span><span class="co">#&gt;  5:                           Proper scoring rule (smaller is better), takes entire predictive distribution into account (global), penalises over- and under-confidence similarly, stable handling of outliers</span></span>
<span><span class="co">#&gt;  6:                               Proper scoring rule, smaller is better, equals negative log of the predictive density at observed value (local), penalises over-confidence severely, susceptible to outliers</span></span>
<span><span class="co">#&gt;  7:                                                              Proper scoring rule, smaller is better, similar properties to CRPS and converges to CRPS for an increasing number of equally spaced intervals</span></span>
<span><span class="co">#&gt;  8:                           Proper scoring rule, smaller is better, evaluates forecast based on mean and sd of predictive distribution (global), susceptible to outliers, penalises over-confidence severely</span></span>
<span><span class="co">#&gt;  9:                                                                                    Proper scoring rule, smaller is better, equals CRPS for binary outcomes, penalises over- and under-confidence similarly</span></span>
<span><span class="co">#&gt; 10:                                                 Proportion of observations falling inside a given central prediction interval (= 'empirical interval coverage'). Used to assess probabilistic calibration.</span></span>
<span><span class="co">#&gt; 11:                                                                                               Average difference between empirical and nominal interval coverage (coverage that should have been realised)</span></span>
<span><span class="co">#&gt; 12:                                                                                         Proportion of observations below a given quantile of the predictive CDF. Used to assess probabilistic calibration.</span></span>
<span><span class="co">#&gt; 13:                                                                                                                                       Dispersion component of WIS, measures width of predictive intervals.</span></span>
<span><span class="co">#&gt; 14:                                                                                                                    Measure for dispersion of a forecast: median of the absolute deviations from the median</span></span>
<span><span class="co">#&gt; 15:                                                                                                                                            Absolute amount of over-or under-prediction (components of WIS)</span></span>
<span><span class="co">#&gt; 16:                                                                                                                                            Absolute amount of over-or under-prediction (components of WIS)</span></span>
<span><span class="co">#&gt; 17:                                                                                   PIT transform is the CDF of the predictive distribution evaluated at the observed values. PIT values should be uniform. </span></span>
<span><span class="co">#&gt; 18:                                                                                                                                       Dispersion component of WIS, measures width of predictive intervals.</span></span>
<span><span class="co">#&gt; 19:                                                                                       Measure of relative tendency to over- or under-predict (aspect of calibration), bounded between -1 and 1 (ideally 0)</span></span>
<span><span class="co">#&gt; 20:                                                                                                             Compares performance of two models. Properties depend on the metric chosen for the comparison.</span></span>
<span><span class="co">#&gt; 21:                                                         Ranks models based on pairwise comparisons, useful in the context of missing forecasts. Properties depend on the metric chosen for the comparison.</span></span>
<span><span class="co">#&gt; 22: Ranks models based on pairwise comparisons, useful in the context of missing forecasts. Scaled (i.e. divided) by the score of a baseline model. Properties depend on the metric chosen for the comparison.</span></span>
<span><span class="co">#&gt;                                                                                                                                                                                                           Info</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="lower-level-functions">Lower level functions<a class="anchor" aria-label="anchor" href="#lower-level-functions"></a>
</h2>
<p>Most of these metrics are available as lower level functions and
extensively documented. Have a look at the help files to understand
these better.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://followtheargument.org/" class="external-link">Nikos Bosse</a>, <a href="https://www.samabbott.co.uk/" class="external-link">Sam Abbott</a>, Hugo Gruson, Sebastian Funk.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
